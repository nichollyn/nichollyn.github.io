<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-center-radar.min.css">
  <script src="/lib/pace/pace.min.js"></script>


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('https://theinfinitegame.tech').hostname,
    root: '/',
    scheme: 'Muse',
    version: '7.6.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false,"b2t":true,"scrollpercent":true},
    copycode: {"enable":true,"show_result":true,"style":"flat"},
    back2top: {"enable":true,"sidebar":true,"scrollpercent":true},
    bookmark: {"enable":true,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="Stay hungry, stay foolish.">
<meta property="og:type" content="website">
<meta property="og:title" content="The Infinite Game">
<meta property="og:url" content="https://theinfinitegame.tech/index.html">
<meta property="og:site_name" content="The Infinite Game">
<meta property="og:description" content="Stay hungry, stay foolish.">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Áå´ÂÖãÊùØ">
<meta property="article:tag" content="tech">
<meta property="article:tag" content=" life">
<meta property="article:tag" content=" philosophy">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://theinfinitegame.tech/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false
  };
</script>

  <title>The Infinite Game</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="The Infinite Game" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">The Infinite Game</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="ÂàáÊç¢ÂØºËà™Ê†è">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>È¶ñÈ°µ</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>ÂΩíÊ°£</a>

  </li>
        <li class="menu-item menu-item-top">

    <a href="/top/" rel="section"><i class="fa fa-fw fa-signal"></i>ÁÉ≠Èó®</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>ÂàÜÁ±ª</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Ê†áÁ≠æ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>ÂÖ≥‰∫é</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404.html" rel="section"><i class="fa fa-fw fa-heartbeat"></i>ÂÖ¨Áõä 404</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>ÊêúÁ¥¢
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="ÊêúÁ¥¢..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/nichollyn" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://theinfinitegame.tech/unity-portfolio/tfaces-game-match-hero-progress-daily-20200310/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Áå´ÂÖãÊùØ">
      <meta itemprop="description" content="Stay hungry, stay foolish.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="The Infinite Game">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/unity-portfolio/tfaces-game-match-hero-progress-daily-20200310/" class="post-title-link" itemprop="url">Unity Tech | How to implement a ‚Äòsacrifice‚Äô skill - take bullets for companion üê∫üê∫üê∫</a>
        </h1>

        <div class="post-meta">

          
            <i class="fa fa-thumb-tack"></i>
            <font color="7D26CD">ÁΩÆÈ°∂</font>
            <span class="post-meta-divider">|</span>
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">ÂèëË°®‰∫é</span>

              <time title="ÂàõÂª∫Êó∂Èó¥Ôºö2020-03-21 10:22:05" itemprop="dateCreated datePublished" datetime="2020-03-21T10:22:05+08:00">2020-03-21</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">ÂàÜÁ±ª‰∫é</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/unity-portfolio/" itemprop="url" rel="index">
                    <span itemprop="name">unity-portfolio</span>
                  </a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Êú¨ÊñáÂ≠óÊï∞">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">Êú¨ÊñáÂ≠óÊï∞Ôºö</span>
              <span>3k</span>
            </span>
            <span class="post-meta-item" title="ÈòÖËØªÊó∂Èïø">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">ÈòÖËØªÊó∂Èïø &asymp;</span>
              <span>3 ÂàÜÈíü</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>In our latest game development, I implemented an interesting action: ‚Äújumping block‚Äù.</p>
<p>The team used this skill on the white wolf guard.  The specific skill is called ‚Äúsacrifice‚Äù. ü§®</p>
<blockquote>
<p>Whenever the wolf leader around him receives deadly ballistic damage, the heroic white wolf guard will take a deep leap and block this damage for his boss.</p>
</blockquote>
<p>Here is the video demonstration:</p>
<video src="https://www.youtube.com/watch?v=LCN8_GVhync" type="video/mp4" controls="controls" width="100%" height="100%">
</video>


<p>And here is the schematic diagram:</p>
<img src="/images/ward fellow by take a bullet for them.png" width="68%" height="68%" style="margin: 10 auto;">


<p>The realization of the jumping block is very interesting ü§™. It is a combination of mathematics and physics.</p>
<p>Let‚Äôs skip the unimportant part and look directly at the most critical code:</p>
<figure class="highlight csharp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> A callback invoked when we find a particle(i.e. our bullet) is flying toward something</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="collisionInstance"&gt;</span>a manager contains information about the particle<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="estimatedArrival"&gt;</span>estimated time of flight<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">OnParticleHeadingToTarget</span>(<span class="params">ParticleCollisionInstance collisionInstance, <span class="keyword">float</span> estimatedArrival</span>)</span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="comment">// Check if the bullet is flying toward our fellow</span></span><br><span class="line">    <span class="keyword">if</span> (collisionInstance != <span class="literal">null</span> &amp;&amp; collisionInstance.HeadingTarget == wolfFellow.gameObject)</span><br><span class="line">    {</span><br><span class="line">        <span class="comment">// Calculate which point should I jump in order to take the bullet for my fellow</span></span><br><span class="line">        jumpSpot = collisionInstance.EvaluateNecessaryArrival(<span class="number">4f</span>, <span class="keyword">out</span> <span class="keyword">float</span> time);</span><br><span class="line">        <span class="comment">// of course, you should look at the bullet when you try to take it.</span></span><br><span class="line">        lookSpot = collisionInstance.gameObject.transform.position;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> Every creature has its react time when something happens</span></span><br><span class="line">        <span class="keyword">float</span> reactTime = (_dollAction <span class="keyword">as</span> WolfDollAction).WardJumpToApexDuration;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (reactTime &lt;= time)</span><br><span class="line">        {</span><br><span class="line">            Invoke(<span class="keyword">nameof</span>(WardFellow), time - reactTime);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Ward fellow, for wolf guard, warding is implemented by jump to take bullet for fellow</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">WardFellow</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    WolfDollAction wolfAction = _dollAction <span class="keyword">as</span> WolfDollAction;</span><br><span class="line"></span><br><span class="line">    wolfAction.TriggerJumpWard(wolfFellow, jumpSpot, lookSpot);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>the mathematical part, <code>EvaluateNecessaryArrival</code>Ôºö</p>
<figure class="highlight csharp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> Evaluate necessary arrival which we must pass through</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="distanceToHeadingTarget"&gt;</span>distance for the arrival to the target<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="estimatedTime"&gt;</span>out parameter, a estimated time by when we arrive<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>the vector of the must-pass arrival<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Vector3 <span class="title">EvaluateNecessaryArrival</span>(<span class="params"><span class="keyword">float</span> distanceToHeadingTarget, <span class="keyword">out</span> <span class="keyword">float</span> estimatedTime</span>)</span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="comment">// Target</span></span><br><span class="line">    <span class="keyword">var</span> heading = HeadingTargetSpot - transform.position;</span><br><span class="line">    <span class="comment">// Distance</span></span><br><span class="line">    <span class="keyword">var</span> currentDistance = heading.magnitude;</span><br><span class="line">    <span class="comment">// Direction</span></span><br><span class="line">    <span class="keyword">var</span> direction = heading / currentDistance;</span><br><span class="line"></span><br><span class="line">    Vector3 arrival = HeadingTargetSpot + direction * -distanceToHeadingTarget;</span><br><span class="line">    estimatedTime = (currentDistance - distanceToHeadingTarget) / MainFlyingParticleVelocity.magnitude;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> arrival;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<p>It‚Äôs not that difficult, right? üôä  Hoping you enjoy this skill. üò¨</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://theinfinitegame.tech/unity-portfolio/tfaces-game-match-hero-progress-daily-20191221/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Áå´ÂÖãÊùØ">
      <meta itemprop="description" content="Stay hungry, stay foolish.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="The Infinite Game">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/unity-portfolio/tfaces-game-match-hero-progress-daily-20191221/" class="post-title-link" itemprop="url">Unity Tech | Meteor rain - Randomly outside, but neatly inside üî•üî•üî•</a>
        </h1>

        <div class="post-meta">

          
            <i class="fa fa-thumb-tack"></i>
            <font color="7D26CD">ÁΩÆÈ°∂</font>
            <span class="post-meta-divider">|</span>
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">ÂèëË°®‰∫é</span>

              <time title="ÂàõÂª∫Êó∂Èó¥Ôºö2019-12-21 14:06:47" itemprop="dateCreated datePublished" datetime="2019-12-21T14:06:47+08:00">2019-12-21</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">ÂàÜÁ±ª‰∫é</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/unity-portfolio/" itemprop="url" rel="index">
                    <span itemprop="name">unity-portfolio</span>
                  </a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Êú¨ÊñáÂ≠óÊï∞">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">Êú¨ÊñáÂ≠óÊï∞Ôºö</span>
              <span>4.9k</span>
            </span>
            <span class="post-meta-item" title="ÈòÖËØªÊó∂Èïø">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">ÈòÖËØªÊó∂Èïø &asymp;</span>
              <span>4 ÂàÜÈíü</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Our team recently researched the special effects of ‚ÄúFlame Rain‚Äù and found many other developers‚Äô solutions from the Internet. They were not very satisfactory for us, mainly because they could not meet the requirements of randomness and precise control at the same time. Finally, we decided to develop a component by ourselves.</p>
<p>We make use of the ‚Äúmachine gun‚Äù component which we develop previously. Machine guns can aim at targets and emit particle effects. The related API and prefabs support multiple targets, bullet prefabs, and the gun body can be rotated.</p>
<p>Our idea is to use many ‚Äúmachine guns‚Äù to build a ‚Äúcloud‚Äù. This ‚Äúcloud‚Äù can cause a regional ‚Äúball rain‚Äù attack on the ground.<br>Of course, this cloud is virtual, and it is not necessary to use render in the scene, it is only used to deploy machine guns. The machine gun is also invisible.</p>
<p>Here is the demo scene we used to verify the bullet cloud function during development:</p>
<p><img src="/images/bullet_cloud.png" width="68%" height="68%" style="margin: 10 auto;"></p>
<p>Because the bullet cloud is usually invisible in the actual scene, you can deploy a bullet cloud anywhere. However, considering the time of flight of the particles, you need to decide the height of the cloud yourself. We implemented it as a well-encapsulated component. You can configure it with any number of raindrops to hit the target precisely (of course, there can be multiple targets), the amount of hit you want to happend on each target, which bullets you want to use. And, there are many other bullets which looks like randomly drop, but actually they are configured by us.</p>
<p>When deploying the bullet cloud to your own scene, you need to pay attention to check the particle effects used as bullets, so you can ensure that there is no layer which can collide with your target.</p>
<p>We applied the previously implemented particles of various projectiles as cloud bullets, which triggered explosions based on physical collisions. At the same time, we determine whether a certain rain process of the bullet cloud is completed based on the collision. This API is necessary for the design of the skill system. Because we need to know when the skills we have released are over.</p>
<p>Of course, if you want to use purely mathematical methods to determine whether the bullet hits the target, this part needs to be implemented by yourself. Our bullet cloud can‚Äôt do that yet.</p>
<p>Using this bullet cloud to achieve the effect of ‚ÄúFlame Rain‚Äù, we are quite satisfied, because it has achieved both randomly effect and accuratly control on the damage. Because many of our game‚Äôs skill look randomly, but their damage amount is fixed.</p>
<p>The implementation logic is still quite complicated, try it:</p>
<figure class="highlight csharp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">EnsurePreciseHitDrop</span>(<span class="params"><span class="keyword">int</span> _preciseHitCount = <span class="number">-1</span></span>)</span></span><br><span class="line"><span class="function"></span>        {</span><br><span class="line">            PreciseHitCount = _preciseHitCount == <span class="number">-1</span> ? preciseHitCountPreset : _preciseHitCount;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (PreciseHitCount &gt; <span class="number">0</span> &amp;&amp; Targets != <span class="literal">null</span> &amp;&amp; Targets.Length &gt; <span class="number">0</span>)</span><br><span class="line">            {</span><br><span class="line">                PreciseHitDrop = <span class="keyword">new</span> Aimer[PreciseHitCount];</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (PreciseHitCount == <span class="number">1</span>)</span><br><span class="line">                {</span><br><span class="line">                    <span class="keyword">if</span> (Targets.Length == <span class="number">1</span>)</span><br><span class="line">                    {</span><br><span class="line">                        PreciseHitDrop[<span class="number">0</span>] = CenterDrop;</span><br><span class="line">                        preciseDropMaxIndexInAllDrop = <span class="number">0</span>;</span><br><span class="line">                    }</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    {</span><br><span class="line">                        Vector3 target = Targets[Random.Range(<span class="number">0</span>, Targets.Length)];</span><br><span class="line"></span><br><span class="line">                        PreciseHitDrop[<span class="number">0</span>] = AllDrop[<span class="number">1</span>];</span><br><span class="line">                        PreciseHitDrop[<span class="number">0</span>].transform.position = DropMoveToAimAtTarget(target);</span><br><span class="line"></span><br><span class="line">                        preciseDropMaxIndexInAllDrop = <span class="number">1</span>;</span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (PreciseHitCount &gt; <span class="number">1</span> &amp;&amp; PreciseHitCount &lt;= DropCount)</span><br><span class="line">                {</span><br><span class="line">                    <span class="keyword">if</span> (Targets.Length == <span class="number">1</span>)</span><br><span class="line">                    {</span><br><span class="line">                        PreciseHitDrop[<span class="number">0</span>] = CenterDrop;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; PreciseHitCount; i++)</span><br><span class="line">                        {</span><br><span class="line">                            PreciseHitDrop[i] = AllDrop[i];</span><br><span class="line">                            PreciseHitDrop[i].transform.position = CenterDrop.transform.position;</span><br><span class="line">                        }</span><br><span class="line"></span><br><span class="line">                        preciseDropMaxIndexInAllDrop = PreciseHitCount - <span class="number">1</span>;</span><br><span class="line">                    }</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (Targets.Length &gt; <span class="number">1</span>)</span><br><span class="line">                    {</span><br><span class="line">                        <span class="keyword">int</span> targetCount = Targets.Length;</span><br><span class="line">                        <span class="keyword">if</span> (EquallyAssignPreciseHit)</span><br><span class="line">                        {</span><br><span class="line">                            <span class="keyword">int</span> quota = PreciseHitCount / targetCount;</span><br><span class="line">                            <span class="keyword">int</span> remain = PreciseHitCount % targetCount;</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">int</span> allDropIndex = <span class="number">1</span>;</span><br><span class="line">                            <span class="keyword">int</span> preciseDropIndex = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">for</span> (<span class="keyword">int</span> targetIndex = <span class="number">0</span>; targetIndex &lt; targetCount; targetIndex++)</span><br><span class="line">                            {</span><br><span class="line">                                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; quota; i++)</span><br><span class="line">                                {</span><br><span class="line">                                    PreciseHitDrop[preciseDropIndex] = AllDrop[allDropIndex];</span><br><span class="line">                                    PreciseHitDrop[preciseDropIndex].transform.position</span><br><span class="line">                                        = DropMoveToAimAtTarget(Targets[targetIndex]);</span><br><span class="line"></span><br><span class="line">                                    allDropIndex++;</span><br><span class="line">                                    preciseDropIndex++;</span><br><span class="line">                                }</span><br><span class="line">                            }</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">if</span> (remain &gt; <span class="number">0</span>)</span><br><span class="line">                            {</span><br><span class="line">                                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; remain; j++)</span><br><span class="line">                                {</span><br><span class="line">                                    Vector3 target = Targets[Random.Range(<span class="number">0</span>, Targets.Length)];</span><br><span class="line"></span><br><span class="line">                                    PreciseHitDrop[preciseDropIndex] = AllDrop[allDropIndex];</span><br><span class="line">                                    PreciseHitDrop[preciseDropIndex].transform.position</span><br><span class="line">                                        = DropMoveToAimAtTarget(target);</span><br><span class="line"></span><br><span class="line">                                    allDropIndex++;</span><br><span class="line">                                    preciseDropIndex++;</span><br><span class="line">                                }</span><br><span class="line">                            }</span><br><span class="line">                        }</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                        {</span><br><span class="line">                            <span class="keyword">int</span> allDropIndex = <span class="number">1</span>;</span><br><span class="line">                            <span class="keyword">int</span> preciseDropIndex = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; PreciseHitCount; i++)</span><br><span class="line">                            {</span><br><span class="line">                                Vector3 target = Targets[Random.Range(<span class="number">0</span>, Targets.Length)];</span><br><span class="line"></span><br><span class="line">                                PreciseHitDrop[preciseDropIndex] = AllDrop[allDropIndex];</span><br><span class="line">                                PreciseHitDrop[preciseDropIndex].transform.position</span><br><span class="line">                                    = DropMoveToAimAtTarget(target);</span><br><span class="line"></span><br><span class="line">                                allDropIndex++;</span><br><span class="line">                                preciseDropIndex++;</span><br><span class="line">                            }</span><br><span class="line">                        }</span><br><span class="line"></span><br><span class="line">                        preciseDropMaxIndexInAllDrop = PreciseHitCount;</span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                {</span><br><span class="line">                    preciseDropMaxIndexInAllDrop = DropCount - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> System.InvalidOperationException(<span class="string">"Precise hit count exceed total drop count."</span>);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://theinfinitegame.tech/development/programming-use-pipeline-to-tackle-complexity/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Áå´ÂÖãÊùØ">
      <meta itemprop="description" content="Stay hungry, stay foolish.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="The Infinite Game">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/development/programming-use-pipeline-to-tackle-complexity/" class="post-title-link" itemprop="url">Áî® ‚ÄúÊµÅÊ∞¥Á∫ø‚Äù ËÆæËÆ°ÊãÜËß£Â§çÊùÇÂ§ÑÁêÜÊµÅÁ®ã</a>
        </h1>

        <div class="post-meta">

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">ÂèëË°®‰∫é</span>

              <time title="ÂàõÂª∫Êó∂Èó¥Ôºö2020-03-17 11:32:12" itemprop="dateCreated datePublished" datetime="2020-03-17T11:32:12+08:00">2020-03-17</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">ÂàÜÁ±ª‰∫é</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/development/" itemprop="url" rel="index">
                    <span itemprop="name">development</span>
                  </a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Êú¨ÊñáÂ≠óÊï∞">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">Êú¨ÊñáÂ≠óÊï∞Ôºö</span>
              <span>8.1k</span>
            </span>
            <span class="post-meta-item" title="ÈòÖËØªÊó∂Èïø">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">ÈòÖËØªÊó∂Èïø &asymp;</span>
              <span>7 ÂàÜÈíü</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>Âª∫ËÆÆÊ®™Â±èÈòÖËØª‰ª£Á†Å</p>
</blockquote>
<ul>
<li>Êú¨ÊñáÁöÑ‰∏ªË¶Å‰ª∑ÂÄºÔºöÊèê‰æõ‰∏ÄÁßçÊäΩË±°Â§çÊùÇÈÄªËæëÔºåËææÊàêÂäüËÉΩÂ§çÁî®ÁöÑÊÄùË∑Ø</li>
<li>ÂÖ≥ÈîÆËØçÔºöËØ≠‰πâÊèêÁÇº„ÄÅÂä®ÊÄÅÂÖ∑Âêç</li>
<li>Êú¨ÊñáÁ∫¶ 4000 Â≠óÔºåÂª∫ËÆÆÈòÖËØªÊó∂Èó¥ 12 ÂàÜÈíü„ÄÇ</li>
</ul>
<h1 id="ÂºïÂ≠ê"><a href="#ÂºïÂ≠ê" class="headerlink" title="ÂºïÂ≠ê"></a>ÂºïÂ≠ê</h1><p>Âú®ËΩØ‰ª∂ÂºÄÂèë‰∏≠ÔºåÊàë‰ª¨Â∏∏Â∏∏‰ºöÈÅáÂà∞‰∏ÄÁßçÂú∫ÊôØÔºöÈöèÁùÄ‰∫ßÂìÅÂäüËÉΩÁöÑÊâ©Â±ïÔºåÂá∫Áé∞‰∫ÜÂ§ö‰∏™ÂÖ∑Â§áÈ´òÂ∫¶Áõ∏‰ººÊÄßÁöÑÂäüËÉΩÂçïÂÖÉ„ÄÇ‰Ωú‰∏∫ÂäüËÉΩÂçïÂÖÉÔºåÂÆÉ‰ª¨ÂèØËÉΩÊúâÁùÄÁõ∏‰ººÁöÑ‰∫§‰∫íÈÄªËæëÔºåÊèê‰æõÂêåÁ±ªÁöÑËæìÂÖ•Êï∞ÊçÆÂíåËæìÂá∫Êï∞ÊçÆ„ÄÇÂπ∂‰∏îÔºåÂØπ‰∫éÁî®Êà∑Êù•ËØ¥ÔºåÂÆÉ‰ª¨ÈÉΩÂú®Â§ÑÁêÜÂêå‰∏Ä‰∏™ÁöÑ‰∏úË•ø„ÄÇ</p>
<p>‰∏æ‰∏™‰æãÂ≠êÔºåÊØîÂ¶Ç‰∏ÄÊ¨æ‰øÆÂõæ app ÔºåÂÆÉÂåÖÂê´‰∫Ü‰∏ÄÁªÑÁºñËæëÂäüËÉΩÔºåÊØè‰∏™ÂäüËÉΩÈÉΩ‰ΩúÁî®‰∫é‰∏ÄÂº†ÂõæÁâáÔºåÂ§ÑÁêÜ‰πãÂêéÁöÑÂõæÁâáÔºåËøòÂèØ‰ª•‰Ωú‰∏∫ÂÖ∂‰ªñÂäüËÉΩÁöÑËæìÂÖ•„ÄÇ‰Ωú‰∏∫ÁºñËæëÂ∑•ÂÖ∑ÔºåÂú®ÊØè‰∏™ÂäüËÉΩÂÜÖÈÉ®ÔºåÂèØËÉΩËøòÈúÄË¶ÅÊîØÊåÅÊí§ÈîÄÂíåÈáçÂÅöËøôÊ†∑ÁöÑÁî®Êà∑Êìç‰Ωú„ÄÇÊàë‰ª¨ÂÆπÊòìÊÉ≥Âà∞ÁöÑÊòØÔºåËøô‰∫õÂäüËÉΩÈó¥Â≠òÂú®ÁùÄËÆ∏Â§öÂèØ‰ª•ËøõË°åÂ§çÁî®ËÆæËÆ°ÁöÑ‰ª£Á†Å„ÄÇ</p>
<p>Êú¨ÊñáÂü∫‰∫é‰∏ÄÊ¨°ÂõûÈ°æÂèëËµ∑ÔºåÂá∫‰∫éËÆ∞ÂΩïÂíåÂàÜ‰∫´ÁöÑÁõÆÁöÑÔºö‰∏ÄÊ¨°‰ª£Á†ÅÈáçÊûÑÔºå‰∏ÄÊ¨æ‰πãÂâçÊàëÂèÇ‰∏éÂºÄÂèëÁöÑÂõæÂÉèÂ§ÑÁêÜÂ∫îÁî®„ÄÇ</p>
<hr>
<h1 id="ÈáçÊûÑÁöÑÂÖ∑‰ΩìËÉåÊôØ"><a href="#ÈáçÊûÑÁöÑÂÖ∑‰ΩìËÉåÊôØ" class="headerlink" title="ÈáçÊûÑÁöÑÂÖ∑‰ΩìËÉåÊôØ"></a>ÈáçÊûÑÁöÑÂÖ∑‰ΩìËÉåÊôØ</h1><p>ËØ∑Áúã‰∏ãÈù¢ËøôÂπÖÂõæÔºö</p>
<p><img src="/images/black_box.png" alt="Êüê‰∏™ÂõæÂÉèÂäüËÉΩÊ®°ÂùóÁöÑÁªìÊûÑÂõæ"></p>
<p>ÂÖÉÁ¥†‰∏çÂ§öÔºåËÆ©ÊàëËß£Èáä‰∏Ä‰∏ã„ÄÇÂõæ‰∏≠ÁöÑ ‚Äú<strong>ÂÜÖÂ≠òÂõæÂÉèÁÆ°ÁêÜ + ÊïàÊûúÂ§ÑÁêÜ</strong>‚Äù ÊòØ‰∏Ä‰∏™ ‚Äú<strong>ÈªëÁõíÂ≠ê</strong>‚Äù„ÄÇ‚ÄúÈÄªËæëÈªëÁõí‚Äù ÊúâÁöÑÊó∂ÂÄôÊòØÂ•Ω‰∫ãÔºåÊúâÁöÑÊó∂ÂÄôÊòØÂùè‰∫ã„ÄÇÈÇ£ËøôÈáåÁöÑÈªëÁõíÂ≠êÁÆóÂ•Ω‰∫ãËøòÊòØÂùè‰∫ãÂë¢Ôºü Êó¢ÁÑ∂ÂØπËøôÁßçËÆæËÆ°ÂÅö‰∫ÜÈáçÊûÑÔºåÂ§öÂçäÊòØÊúâÁóõÁÇπ‰∫Ü„ÄÇËøôÈáåÔºåÊàë‰ª¨ÈáçÁÇπÊé¢ËÆ®‰∏Ä‰∏ãÂÆÉÁöÑË¥üÈù¢ÊïàÂ∫î„ÄÇ </p>
<p>Âú®ÂÖ∑‰Ωì‰∏öÂä°Âú∫ÊôØ‰∏ãÔºåËøô‰∏™ÈªëÁõíÂ≠êÊúâ‰∏§‰∏™ÈóÆÈ¢òÔºö</p>
<ul>
<li>ÂõæÂÉèÂ§ÑÁêÜÊé•Âè£Á≤íÂ∫¶Â§™Â§ßÔºåÈöæ‰ª•Â§çÁî®‰ª£Á†ÅÔºõ</li>
<li>ÂõæÂÉè <strong>ÁÆ°ÁêÜ</strong> ÂíåÂõæÂÉè <strong>ÊïàÊûúÂ§ÑÁêÜ</strong> Ë¢´ÁªëÂÆöÂú®‰∏ÄËµ∑„ÄÇ‰ΩøÂæóÂ§ñÈÉ®Èöæ‰ª•ÁÅµÊ¥ªÁöÑÊé•Ëß¶Âíå‰ΩøÁî®ÂõæÂÉè„ÄÇÂº∫Ë∞É‰∏Ä‰∏ãÔºåÁÆ°ÁêÜÂíåÊïàÊûúÂ§ÑÁêÜÊòØ‰∏§‰ª∂‰∫ã„ÄÇÂâçËÄÖÊòØÁ´ôÂú®Áî®Êà∑ÁöÑËßíÂ∫¶ÔºåÂêéËÄÖÊòØÁ´ôÂú®ÊúçÂä°Êèê‰æõËÄÖÁöÑËßíÂ∫¶„ÄÇÊõ¥È´òÂ±ÇÂ∫îÁî®ÈÄªËæëÁöÑÂºÄÂèëËÄÖÔºåÂØπ‰∫éÊõ¥Â∫ïÂ±ÇÊîØÊíë API ÁöÑÂºÄÂèëËÄÖÊù•ËØ¥Ôºå‰πüÊòØÁî®Êà∑„ÄÇ</li>
</ul>
<h1 id="‚ÄúÁÆ°ÈÅì‚Äù-Ê¶ÇÂøµÁöÑÊèêÁÇº"><a href="#‚ÄúÁÆ°ÈÅì‚Äù-Ê¶ÇÂøµÁöÑÊèêÁÇº" class="headerlink" title="‚ÄúÁÆ°ÈÅì‚Äù Ê¶ÇÂøµÁöÑÊèêÁÇº"></a>‚ÄúÁÆ°ÈÅì‚Äù Ê¶ÇÂøµÁöÑÊèêÁÇº</h1><p>ÈªëÁõíÂ≠êÁöÑ‰∏§‰∏™ÈóÆÈ¢òÂú®ÈáçÊûÑÊó∂ÈÉΩÂæóÂà∞‰∫ÜËß£ÂÜ≥Ôºå‰ΩÜÁ¨¨‰∏Ä‰∏™ÈóÆÈ¢ò‰∏éÊú¨ÊñáË¶ÅÂàÜ‰∫´ÁöÑËÆæËÆ°ÊÄùÊÉ≥ÂÖ≥ËÅî‰∏çÂ§ßÔºå‰∏çÂÅöÂ±ïÂºÄ„ÄÇ</p>
<p>‰∏∫‰∫ÜËØ¥ÊòéÊàë‰ª¨ÊòØÂ¶Ç‰ΩïËß£ÂÜ≥Á¨¨‰∫å‰∏™ÈóÆÈ¢òÁöÑÔºåËøôÈáåÂÖàÂºïÂÖ•‰∏§‰∏™Ê¶ÇÂøµÔºö‚Äú<strong>ÊµÅÊ∞¥Á∫ø</strong>‚Äù Âíå ‚Äú<strong>‰æãÁ®ã</strong>‚Äù„ÄÇÁõ∏‰ø°ÂØπ‰∫é‰ªé‰∫ãÁºñÁ®ãÁ±ªÂ∑•‰ΩúÁöÑËØªËÄÖÊù•ËØ¥ÔºåËøô‰∏§‰∏™ËØç‰∏ç‰ºöÈôåÁîü„ÄÇ</p>
<blockquote>
<p><strong>ÊµÅÊ∞¥Á∫ø</strong>  pipelineÔºå[ËÆ°] ÂèàÁß∞ÁÆ°ÈÅìÔºåÁÆ°Á∫ø„ÄÇ<br><strong>‰æãÁ®ã</strong>  routineÔºå[ËÆ°] Á®ãÂ∫èÔºõÊó•Â∏∏Â∑•‰ΩúÔºõ‰æãË°åÂÖ¨‰∫ã</p>
</blockquote>
<p>Âú®Êàë‰ª¨ÁöÑÊ°à‰æã‰∏≠Ôºå<code>Pipeline</code> Áõ∏ÂΩì‰∫éÂÜÖÂ≠ò‰∏≠ÁöÑÂõæÂÉèÁä∂ÊÄÅÊú∫ÔºåÊèê‰æõ‰∫ÜÂü∫Êú¨ÁöÑÂõæÂÉèÁÆ°ÁêÜÂäüËÉΩÔºå‰æãÂ¶ÇÂä†ÂÖ•ÂõæÂÉèÔºåÂà†Èô§ÂõæÂÉèÔºåÂ§çÂà∂ÂõæÂÉèÔºåÁßªÂä®ÂõæÂÉèÔºåÁ≠âÁ≠â„ÄÇ<code>Routine</code> Áõ∏ÂΩì‰∫éÂêÑ‰∏™ÂõæÂÉèÂäüËÉΩÂçïÂÖÉ‰∏≠ÁöÑÈÄöÁî®‰∫ãÂä°ÔºåÊØîÂ¶ÇËØ¥ÔºåÂØπ‰∫éÊØè‰∏™ÂõæÂÉèÂäüËÉΩÂçïÂÖÉÔºåÈÉΩÈúÄË¶ÅÂú®ÂÖ∂ÂºÄÂßãËøê‰ΩúÊó∂‰ªéÊüêÂ§ÑËé∑Âæó‰∏Ä‰ªΩÂàùÂßãÁöÑÂõæÂÉèÔºåÂπ∂Âú®ÂÖ∂ÁªìÊùüËøê‰ΩúÊó∂ËæìÂá∫‰∏Ä‰ªΩ <strong><em>ÊúÄÁªàÁöÑ</em></strong> ÂõæÂÉèÂà∞Âè¶‰∏ÄÂ§Ñ„ÄÇÊàë‰ª¨ËøòÁ∫¶ÂÆöÔºå<code>Routine</code> ‰∏≠ÁöÑ‰∫ãÂä°‰ºöÂü∫‰∫é <code>Pipeline</code> Êù•ÂÆåÊàê„ÄÇÂèØ‰ª•ÂÖ∑‰ΩìËß£ÈáäÊàêËøôÊ†∑ÔºöÊØè‰∏™ <code>Routine</code> ÈÉΩ‰ºöÂåÖÂê´‰∏ÄÁªÑÂÖ∏ÂûãÁöÑÂõæÂÉèÂ§ÑÁêÜÂä®‰ΩúÔºåËøô‰∫õÂ§ÑÁêÜÂä®‰ΩúÂÄüÂä©‰∏Ä‰∏™ÊàñËÄÖÂ§ö‰∏™ <code>Pipeline</code> ÁöÑÈÄöÁî®Êìç‰ΩúÔºå‰ª•ÂèäÊØè‰∏™ <code>Pipeline</code> ÁöÑÂ∑ÆÂºÇÂåñÊìç‰ΩúÊù•ÂÆåÊàêÔºàÂêéÈù¢‰ºöÂÖ∑‰ΩìËØ¥ÊòéËøô‰∏™ <strong><em>Â∑ÆÂºÇÂåñÁöÑÂõæÂÉèÂ§ÑÁêÜÊ≠•È™§</em></strong>Ôºâ„ÄÇ</p>
<p>‰ªéËøôÈáåÂºÄÂßãÔºåÊàë‰ª¨‰∏çÂ¶®Êää ‚Äú<strong>ÊµÅÊ∞¥Á∫ø</strong>‚Äù ÁöÑÂè´Ê≥ïÁõ¥Êé•ÊõøÊç¢Êàê ‚Äú<strong>ÁÆ°ÈÅì</strong>‚ÄùÔºåÂõ†‰∏∫ÂêéÈù¢‰ºöÁî®Âà∞‰∏Ä‰∫õÊØîÂñªÊÄßÁöÑÊèèËø∞ÔºåÊàë‰∏™‰∫∫ÂÆÉ‰ª¨ËßâÂæóÂü∫‰∫é ‚ÄúÁÆ°ÈÅì‚Äù ‰∏ÄËØçË°çÁîüÂá∫Êù•Ôºå‰ºöÊØîÁî® ‚ÄúÊµÅÊ∞¥Á∫ø‚Äù Êù•ÂæóÊõ¥Ëá™ÁÑ∂„ÄÇÊé•‰∏ãÊù•ÔºåÊàë‰ª¨ÂØπ ‚ÄúÁÆ°ÈÅì‚Äù Ëøô‰∏™ÊÑèË±°ÂÜçÂÅöËøõ‰∏ÄÊ≠•ÁöÑÊåñÊéòÔºåÂèØ‰ª•ËÆæËÆ°Âá∫‰∏ãÈù¢Ëøô‰∫õÂØπÂ∫îÂÖ≥Á≥ªÔºàË°®Ê†º‰∏≠Â∑¶‰æßÁöÑÊ¶ÇÂøµÂè™ÊòØ‰∏ÄÁßçÊØîÂñªÔºåËØªËÄÖÂèØËá™Ë°å‰Ωì‰ºöÔºåËøôÈáå‰∏ç‰ºöËØ¶ÁªÜËß£ËØªÔºâ</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>ÊØîÂñª</th>
<th>ÂéüÂØπË±° </th>
</tr>
</thead>
<tbody>
<tr>
<td>‚ÄúÁÆ°ÈÅì‚Äù</td>
<td>ÂõæÂÉèÁä∂ÊÄÅÊú∫</td>
</tr>
<tr>
<td>‚ÄúÊµÅ‰Ωì‚Äù</td>
<td>ÂõæÂÉè</td>
</tr>
<tr>
<td>‚ÄúËäÇÁÇπ‚Äù</td>
<td>ÂõæÂÉèÁä∂ÊÄÅ</td>
</tr>
<tr>
<td>‚ÄúÊµÅÂä®‚Äù</td>
<td>ÂõæÂÉèÁä∂ÊÄÅÊµÅËΩ¨</td>
</tr>
<tr>
<td>‚ÄúÈîãÈù¢‚Äù(ÊµÅ‰ΩìÁöÑÊúÄÂâçÁ´Ø)</td>
<td>ÂΩìÂâçÊ≠£Âú®Â§ÑÁêÜÁöÑÂõæÂÉèÁä∂ÊÄÅ</td>
</tr>
<tr>
<td>‚ÄúËøûÈÄöÊÄß‚Äù</td>
<td>Áä∂ÊÄÅÊú∫ÂÜÖÁöÑÂõæÂÉè‰ª•ÂèäÂõæÂÉèÁä∂ÊÄÅÊú∫‰πãÈó¥ÈÉΩÊòØÂèØ‰∏≤ËÅîÁöÑ</td>
</tr>
</tbody>
</table>
</div>
<p>‚ÄúÊµÅ‰Ωì‚Äù ÊòØ‰∏Ä‰∏™ÂêçËØçÔºåÂÆÉÂØπÂ∫îÁöÑÊòØÂõæÂÉèÔºåÊ∂âÂèäÂà∞Â≠òÂÇ®Ê®°Âûã„ÄÇÊ†πÊçÆ ‚ÄúÊµÅ‰Ωì‚Äù ÁöÑÁâπÊÄßÔºåÊàë‰ª¨ÂèØ‰ª•ÊÉ≥Ë±°ÔºåÊàñËÄÖËØ¥Êé®Êñ≠ÔºåÁÆ°ÈÅìÈáåÁöÑÂõæÂÉèÂ≠òÂÇ®Ê®°ÂûãÂ∫îËØ•‰ºöË¢´ËÆæËÆ°‰∏∫Âπ≥Ë°åÁªìÊûÑ„ÄÇ</p>
<p>ËØ∑ËØªËÄÖËÅîÊÉ≥‰∏Ä‰∏™Á±ªÊØîÔºå &lt;__ÂåñÂ¶Ü / Êï¥ÂÆπ  VS  ËΩØ‰ª∂‰∏äÁæéÂåñÁÖßÁâá‰∏äÁöÑ‰∫∫ËÑ∏__&gt; ÔºåÂÜçÊÄùËÄÉ‰∏Ä‰∏ãÔºå‰∏§ËÄÖÂú®Â≠òÂÇ®Ê®°ÂûãÂíåÂ∑•Â∫èËøô‰∏§‰∏™ÊñπÈù¢Êúâ‰ªÄ‰πàÂºÇÂêåÔºü </p>
<p>ÂõûÂà∞Ê≠£È¢òÔºåÊàëÈÖç‰∫Ü‰∫îÂπÖÂõæÊù•ÊèèËø∞ÁÆ°ÈÅìÂú®ÂÖ∑‰ΩìÂÆûÁé∞‰∏≠ÁöÑ‰∫î‰∏™ÁâπÊÄßÔºö</p>
<ol>
<li>‚ÄúÊµÅ‰Ωì‚Äù Áî±‰∏ÄÁ≥ªÂàó ‚ÄúËäÇÁÇπ‚Äù ÁªÑÊàê„ÄÇ‚ÄúËäÇÁÇπ‚ÄùÔºåÂç≥ÂõæÂÉèÁöÑÁä∂ÊÄÅÔºåÂÆÉÁöÑÂê´‰πâÊûÑÊàê‰∫ÜÊàë‰ª¨ÂØπÊüê‰∏Ä‰∏™ÂõæÂÉèÁöÑÊú¨ÂæÅÊÄßËÆ§Áü•„ÄÇÈÄö‰øóÂú∞ËÆ≤ÔºåÂõæÂÉèÁä∂ÊÄÅËÉΩÂ§üÂ∏ÆÂä©Êàë‰ª¨Âú®ÁâπÂÆöÁöÑÂú∫ÊôØ‰∏ãÊää‰∏çÂêåÁöÑÂõæÂÉèÂå∫ÂàÜÂºÄÊù•„ÄÇ‰∏æ‰∏™‰æãÂ≠êÔºåÊúâÂçèÂêåÂºÄÂèëÁöÑ‰∏§‰ΩçÁ®ãÂ∫èÂëòÔºåÂØπ‰∫é ‚ÄúÁæéÈ¢ú‚Äù Âíå ‚ÄúÊª§Èïú‚Äù Ëøô‰∏§‰∏™Ê≠•È™§ÁöÑËÆ§Áü•ËææÊàê‰∫ÜÂÖ±ËØÜ„ÄÇ‰∫éÊòØÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Âª∫Á´ã‰∏§‰∏™ËäÇÁÇπÔºö‚ÄúÁæéÈ¢ú‚Äù„ÄÅ‚ÄúÊª§Èïú‚ÄùÔºåÁÑ∂ÂêéÂú®ÂºÄÂèëËøáÁ®ã‰∏≠‰ΩøÁî®Ëøô‰∏§‰∏™ËäÇÁÇπÊù• <em>Âçè‰Ωú</em> „ÄÇÊ≥®ÊÑèÔºåÂõæÂÉèÁä∂ÊÄÅ‰∏çÊòØÂõæÂÉèÊú¨Ë∫´„ÄÇÂØπ‰∫éÂõæÂÉèÁä∂ÊÄÅÁöÑ‰ª£Á†ÅÂÆûÁé∞ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®‰∏Ä‰∏™ÊûÅËΩªÈáèÁöÑÊï∞ÊçÆÁªìÊûÑ ‚Äî‚Äî Â≠óÁ¨¶‰∏≤„ÄÇÂÆÉ‰ΩìÁé∞ÁöÑÊòØ <strong>Âç†‰ΩçÁ¨¶ÊÄùÊÉ≥</strong>ÔºåËÄåÊàëÊÉ≥Ë¶ÅÂº∫Ë∞ÉÂç†‰ΩçÁ¨¶ÁöÑ‰∏â‰∏™ÈáçË¶ÅÂ•ΩÂ§ÑÔºöÂÆÉ‰ª¨ÊòØ <strong>ÂèØÈ¢ÑËßÅÁöÑ</strong>ÔºàÂü∫‰∫éËÆ§Áü•ÂÖ±ËØÜÔºâ„ÄÅ<strong>ÂèØÈ¢ÑÁΩÆÁöÑ</strong>ÔºàÂæàËΩªÈáèÔºâ„ÄÅ<strong>ÂèØÂõ∫ÂåñÁöÑ</strong>ÔºàÂèØÂ§çÁî®‰ª£Á†ÅÁöÑ‰∏Ä‰∏™ÂÜÖÂú®Ë¶ÅÊ±ÇÔºâ„ÄÇ</li>
</ol>
<p><img src="/images/nodes.png" alt="ËäÇÁÇπÂèäÂêå‰ΩçËäÇÁÇπ"></p>
<ol>
<li>‚ÄúÁÆ°ÈÅì‚Äù ÈÄöËøáË°îÊé• ‚ÄúËäÇÁÇπ‚Äù ÊûÑÊàê ‚ÄúËøûÈÄö‚Äù„ÄÇÂú® ‚ÄúËäÇÁÇπ‚Äù ‰∏≠ÔºåÊúâÂøÖË¶ÅÁâπÂà´‰ªãÁªçÁöÑÊòØ ‚ÄúÂêå‰ΩçËäÇÁÇπ‚Äù„ÄÇÂÆÉÊåáÁöÑÊòØÔºöÂá†‰∏™Ê≠•È™§Âú® <strong>Âêå‰∏Ä‰∏™ÂõæÂÉè</strong> ‰∏äÂÖàÂêéÂèëÁîü„ÄÇÂú®Êó∂Èó¥‰∏äÊúâÂÖàÂêéÔºå‰ΩÜÂú®Á©∫Èó¥‰∏äÂßãÁªàÊìç‰ΩúÂêå‰∏Ä‰ªΩÂ≠òÂÇ®„ÄÇÊàëÂêéÈù¢‰ºöÂÜçÁî®Âà∞Ëøô‰∏™ÊèèËø∞„ÄÇ</li>
</ol>
<p><img src="/images/connectivity.png" alt="ËøûÈÄöÊÄß"></p>
<ol>
<li><p>‚ÄúÊµÅÂä®‚Äù ÁöÑ ‚ÄúÊµÅ‰Ωì‚Äù ‰ºöÊúâ‰∏Ä‰∏™ <strong>ÊúÄÂâçÈÉ®</strong> ÔºåÂ∞±Â•ΩÂÉèÊ∞¥ÊµÅÁöÑÊúÄÂâçÁ´ØÔºåÂèàÁß∞‰∏∫ ‚ÄúÈîãÈù¢‚Äù (Waterfront)ÔºåÂØπÂ∫îÁùÄËøôÊ†∑‰∏Ä‰∏™‰∫ãÂÆûÔºö‚ÄúÁÆ°ÈÅì‚Äù ‰∏≠ÊâÄÊúâÁöÑÂõæÂÉèÔºåÂú®Âêå‰∏ÄÊó∂Èó¥ÈáåÔºåÂè™‰ºöÊúâ <strong>ÂîØ‰∏ÄÁöÑ</strong> ÂõæÂÉèÂ§Ñ‰∫é <strong>ÂèØÊìç‰Ωú</strong> ÁöÑÁä∂ÊÄÅÔºåËøô‰∏™Áä∂ÊÄÅ‰ª£Ë°®ÁùÄ <strong>ÂõæÂÉèÁöÑÂèòÂåñË∂ãÂäø</strong> „ÄÇÂÖ∑‰ΩìÂà∞‰ª£Á†ÅÂÆûÁé∞ÔºåÂèØËÉΩ‰ºöÊòØ‰∏ÄÁªÑÂ∏¶Êúâ <em> ÂêåÊ≠•ÂÖ≥ÈîÆÂ≠ó </em> ÁöÑÊñπÊ≥ïÔºåÂä†‰∏ä‰∏Ä‰∏™ÂîØ‰∏ÄÁöÑÊåáÂêëÂΩìÂâçÁä∂ÊÄÅÁöÑÊåáÈíà„ÄÇÊàë‰ª¨ÈÄöËøá <strong>ÂºïÂØº</strong> Âíå <strong>ÊìçÂàÄ</strong> Ëøô‰∏™Ë∂ãÂäøÔºåÊääÂõæÂÉè ‚ÄúÂºïÂêë‚Äù ÊúÄÁªàË¶ÅÂëàÁé∞Âá∫Êù•ÁöÑÊ†∑Â≠ê„ÄÇÂú®ÂõæÁ§∫‰∏≠ÔºåÊàëÊúâÊÑè‰ΩøÁî®‰∫ÜÁªøËâ≤‰ª£Ë°®ÂéüÂßãÁöÑ„ÄÅÊúÄÂàùÁöÑÔºå‰ΩøÁî®Á∫¢Ëâ≤‰ª£Ë°®ÊàêÁÜüÁöÑ„ÄÅÂÆåÂÖ®‰ΩìÁöÑ„ÄÇ<code>Pipeline</code> ‰∏ìÊ≥®‰∫éÂÅö‰∏Ä‰ª∂‰∫ãÔºöÊääÂõæÂÉè‰ªé‰∏ÄÁßçÁä∂ÊÄÅËΩ¨Âåñ‰∏∫Âè¶Â§ñ‰∏ÄÁßçÁä∂ÊÄÅ„ÄÇËøôÊúüÈó¥ÔºåÂèØËÉΩË¶ÅÁªèÂéÜÂ§ö‰∏™ ‚ÄúËäÇÁÇπ‚ÄùÔºåËÄå ‚ÄúÈîãÈù¢‚Äù ÁöÑÊÑè‰πâÂ∞±Âú®‰∫éÔºåÂÆÉ‰øùËØÅ‰∫Ü‰∏Ä‰ª∂‰∫ã„ÄÇÈÇ£Â∞±ÊòØ <code>Pipeline</code> ÁöÑÊìçÂàÄËÄÖÂèØ‰ª•Á°Æ‰ø°ÔºåËøô‰∏ÄÂàªÂè™Êúâ‰ªñËá™Â∑±Âú®ÂºïÂØºÂõæÂÉèÁöÑ ‚ÄúÊµÅÂêë‚ÄùÔºåÊ≤°Êúâ‰∫∫‰ºöÂπ≤Êâ∞Âà∞‰ªñ„ÄÇ</p>
<p><img src="/images/waterfront.png" alt="ÈîãÈù¢"></p>
</li>
<li><p>‚ÄúÊµÅÂä®‚Äù ÂèØ‰ª•ÊòØÂèåÂêëÁöÑÔºàÁõ∏ÊØîÁîü‰∫ßËΩ¶Èó¥ÁöÑ ‚ÄúÊµÅÊ∞¥Á∫ø‚ÄùÔºå‚ÄúÁÆ°ÈÅì‚Äù ‰πãÊâÄ‰ª•Êõ¥Ë¥¥ÂàáÔºåÂú®‰∫éÂêéËÄÖÂèØ‰ª•ÂÆûÁé∞ÂèåÂêëÁöÑÊµÅÂä®ÔºåÂØπÂ∫îÂà∞ÂõæÂÉèÔºåÁõ∏ÂΩì‰∫éÂÆûÁé∞ÂèçÂêëÁºñËæëÔºåÊàñËÄÖËØ¥Êí§ÈîÄÂà∞‰∏Ä‰∏™Â§ÑÁêÜÊ≠•È™§‰πãÂâçÁöÑÁä∂ÊÄÅÔºâ</p>
</li>
<li><p>‚ÄúÊµÅ‰Ωì‚Äù Â¶ÇÊûú ‚ÄúÂàÜÊµÅ‚ÄùÔºåÂàôÂèØ‰ª•Âá∫Áé∞Â§ö‰∏™ ‚ÄúÈîãÈù¢‚ÄùÔºåÂØπÂ∫îÁùÄÂõæÂÉèÁöÑ <strong>Âπ∂Ë°åÂ§ÑÁêÜ</strong> „ÄÇ</p>
<p><img src="/images/shunt.png" alt="ÂàÜÊµÅ"></p>
</li>
</ol>
<h1 id="‚ÄúÁÆ°ÈÅì‚Äù-ÁöÑÂÖ∑‰ΩìÂÆûÁé∞"><a href="#‚ÄúÁÆ°ÈÅì‚Äù-ÁöÑÂÖ∑‰ΩìÂÆûÁé∞" class="headerlink" title="‚ÄúÁÆ°ÈÅì‚Äù ÁöÑÂÖ∑‰ΩìÂÆûÁé∞"></a>‚ÄúÁÆ°ÈÅì‚Äù ÁöÑÂÖ∑‰ΩìÂÆûÁé∞</h1><p>Â¶ÇÂâçÊâÄËø∞Ôºå‚ÄúÊµÅ‰Ωì‚Äù ÂÖ∂ÂÆûÂ∞±ÊòØÂõæÂÉèÔºåÁÆÄÂçïÂ∞ÅË£ÖÂç≥ÂèØ„ÄÇÊàë‰ª¨‰∏ªË¶ÅÂÆûÁé∞ÁöÑÊòØ ‚Äú<strong>ËäÇÁÇπ</strong>‚Äù„ÄÅ‚Äú<strong>ÈîãÈù¢</strong>‚Äù„ÄÅ ‚Äú<strong>ÊµÅÂä®</strong>‚Äù Âíå ‚Äú<strong>ËøûÈÄö</strong>‚Äù„ÄÇ</p>
<h2 id="ËäÇÁÇπÁöÑÂÆûÁé∞ÊñπÊ°àÂíåÊÑè‰πâ"><a href="#ËäÇÁÇπÁöÑÂÆûÁé∞ÊñπÊ°àÂíåÊÑè‰πâ" class="headerlink" title="ËäÇÁÇπÁöÑÂÆûÁé∞ÊñπÊ°àÂíåÊÑè‰πâ"></a>ËäÇÁÇπÁöÑÂÆûÁé∞ÊñπÊ°àÂíåÊÑè‰πâ</h2><p>Êàë‰ª¨ÂÖàÊù•Áúã‰∏ÄÁßçÂÖ∏ÂûãÁöÑÂõæÂÉèÂ§ÑÁêÜËøáÁ®ã‰∏≠ÂèØËÉΩ‰ºöÈááÁî®ÁöÑÂÜôÊ≥ïÔºå‰ª£Á†Å‰∏∫ swift ÂÆûÁé∞Ôºö</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ÂõæÂÉè xyz</span></span><br><span class="line"><span class="keyword">var</span> xyz: <span class="type">MyImage</span></span><br><span class="line"><span class="comment">// ÂõæÂÉè ijk</span></span><br><span class="line"><span class="keyword">var</span> ijk: <span class="type">MyImage</span></span><br><span class="line"><span class="comment">// ÂõæÂÉè abc </span></span><br><span class="line"><span class="keyword">var</span> abc: <span class="type">MyImage</span></span><br></pre></td></tr></tbody></table></figure>
<p>ÂΩìÁÑ∂ÔºåÁé∞‰ª£ÁºñÁ®ãËØ≠Ë®ÄÁöÑËØ≠Ê≥ïÁâπÊÄßÔºåÂèØ‰ª•ËÆ©‰Ω†ÁúÅÂéªÂÜôÂêÑÁßç getter/setter ÁöÑÊ†∑Êùø‰ª£Á†ÅÔºå‰ªéËÄåËäÇÁúÅ‰ª£Á†ÅÈáè„ÄÇ‰ΩÜËøô‰∏çÊòØÈáçÁÇπÔºåÈáçÁÇπÂú®‰∫é ‚Äî‚Äî ‰∏äËø∞ËøôÁßç‰ª£Á†ÅÊó†Ê≥ïÂ§çÁî®„ÄÇÂõ†‰∏∫ÊØè‰∏Ä‰∏™ÂõæÂÉèÁöÑÂºïÁî®ÈÉΩË¢´Ëµã‰∫à‰∫Ü <strong>ÂÖ∑‰Ωì</strong> ÁöÑÂê´‰πâÔºöÂêåÊ†∑ÁöÑÂÜôÊ≥ï‰∏çÂ§™ÂèØËÉΩÂÆåÂÖ®Âú∞ÈÄÇÁî®‰∫éÂè¶Â§ñ‰∏Ä‰∏™ÂõæÂÉèÂ§ÑÁêÜÂú∫ÊôØ„ÄÇÊØîÂ¶ÇËØ¥ÔºåÂè¶Â§ñÈÇ£‰∏™ÂõæÂÉèÂ§ÑÁêÜÂú∫ÊôØÂæàÂèØËÉΩ‰∏ç‰ºöÁî®Âà∞ÊèèËø∞‰∏∫ ijk ÁöÑÂõæÂÉèÔºåÂèØËÉΩ‰ºöÁî®Âà∞ÊèèËø∞ÊòØ uvw ÁöÑÂõæÂÉè„ÄÇÂõ†Ê≠§ÔºåÈááÂèñËøôÁßçÂÜôÊ≥ï‰ºöÈÅáÂà∞ÁöÑ‰∏Ä‰∏™ÂÖ∏ÂûãÈóÆÈ¢òÊòØÔºöÊØèÊñ∞Â¢û‰∏Ä‰∏™ÂõæÂÉèÂ§ÑÁêÜÂú∫ÊôØÔºåÊàë‰ª¨ÈÉΩÈúÄË¶ÅÊñ∞Â¢ûËã•Âπ≤‰∏™ÁâπÂÆöÊèèËø∞ÁöÑÂõæÂÉèÂ£∞Êòé„ÄÇÂú®ÁºñÁ†ÅÂ±ÇÈù¢ÔºåËøôÊó†ÁñëÊòØ‰∏ÄÈ°πÁπÅÂÜóÁöÑÂ∑•‰Ωú„ÄÇ</p>
<p>‰∏äÈù¢ËØ¥ÁöÑÂõæÂÉèÂºïÁî®ÔºåÂÖ∂ÂÆûÊ≠£ÊòØÊàë‰ª¨ÁöÑÂõæÂÉè ‚ÄúÁÆ°ÈÅì‚Äù ÈáåÁöÑÊüê‰∏™ ‚ÄúËäÇÁÇπ‚Äù„ÄÇÊÄùËÄÉ‰∏Ä‰∏™ÈóÆÈ¢òÔºåÂ¶ÇÊûúË¶ÅÂØπ ‚ÄúËäÇÁÇπ‚Äù ÂÆûÁé∞‰ª£Á†ÅÂ§çÁî®Ôºå‰Ω†‰ºöÊÄé‰πàÂÅöÔºüÁ®çÂæÆÊèêÁ§∫‰∏Ä‰∏ãÔºåÂÖ≥ÈîÆÂú®‰∫é ‚Äú<strong>ÂÖ∑‰Ωì</strong>‚Äù Ëøô‰∏§‰∏™Â≠ó„ÄÇ</p>
<p>ÊòØÁöÑÔºåÂ¶ÇÊûúÊàë‰ª¨ËÉΩÊÉ≥Âà∞Ôºå‰∏äÈù¢ÁöÑÂÜôÊ≥ï‰∏≠‰ª£Á†Å‰πãÊâÄ‰ª•‰∏çËÉΩÂ§çÁî®ÔºåÊ†πÊ∫êÂú®‰∫éÂõæÂÉèÂºïÁî®ÁöÑÁî®ÈÄîÂ∑≤ÁªèË¢´ <strong>ÂÖ∑‰ΩìÂÆö‰πâ</strong>ÔºàÂêåÊó∂‰πüÊòØË¢´ÂÖ∑‰Ωì <strong>Á∫¶Êùü</strong>ÔºâÔºåÈÇ£‰πàÊàë‰ª¨Â∞±Êõ¥ÊúâÂèØËÉΩÂæÄËøôÊ†∑‰∏Ä‰∏™ÊñπÂêëÊÄùËÄÉÈóÆÈ¢òÁöÑËß£ÂÜ≥ÊñπÊ°àÔºöËÉΩ‰∏çËÉΩÊääÂõæÂÉèÂºïÁî® ‚ÄúÂéªÂÖ∑‰ΩìÂåñ‚Äù ÔºåËÆ©ÂÆÉÁöÑÂê´‰πâÂú®ÂÖ∑‰ΩìÂú∫ÊôØÂà∞Êù•Êó∂ÊâçË¢´Ëµã‰∫àÂë¢Ôºü</p>
<p>ËÆ≤Âà∞Ëøô‰∏ÄÂ±ÇÔºåÊúâ‰∫õËØªËÄÖÂèØËÉΩÂ∑≤ÁªèÊÉ≥Âà∞‰∏ÄÁßçÊï∞ÊçÆÁªìÊûÑ ‚Äî‚Äî Â≠óÂÖ∏„ÄÇÊòØÁöÑÔºåÊ≤°Êúâ‰ªÄ‰πàÂ•áÊ∑´Â∑ßÊäÄÔºåÂè™Áî®Â≠óÂÖ∏ÔºåÂ∞±ËÉΩÂÆûÁé∞ ‚ÄúÂéªÂÖ∑‰ΩìÂåñ‚ÄùÔºåËß£ÂÜ≥Ëøô‰∏™‰ª£Á†ÅÂ§çÁî®ÈóÆÈ¢ò‰∏≠ÁöÑÊúÄÂ§ßÈöúÁ¢ç ‚Äî‚Äî Êó¢ÁÑ∂Êó†Ê≥ïÈ¢ÑÁü•Êàë‰ª¨ÂèØËÉΩÈúÄË¶ÅÂ§ÑÁêÜ‰ªÄ‰πàÊ†∑ÁöÑÂõæÂÉèÔºåÂèØËÉΩÈúÄË¶ÅÂ§ÑÁêÜÂ§öÂ∞ë‰ªΩÂõæÂÉèÔºåÂπ∂‰∏îËøô‰∫õÊú™Áü•Êï∞ÊÄªÊòØÊòìÂèòÁöÑÔºåÈÇ£‰∏∫‰ªÄ‰πà‰∏çËÆ©ÂÖ∑‰ΩìÂú∫ÊôØÁöÑ‰ΩøÁî®ËÄÖÊù• <strong>Âä®ÊÄÅÊ∑ªÂä†</strong> Ëøô‰∫õÂõæÂÉèÂºïÁî®ÔºåÂπ∂‰∏î‰∏∫ÂÆÉ‰ª¨ÂÖ∑ÂêçÂë¢ÔºüÂõæÂÉèÈÉ®ÂàÜË¢´Â§çÁî®ÁöÑ‰ª£Á†ÅÔºåËøôÈáåÂè™Â£∞Êòé‰∫Ü‰∏ÄÊ†∑‰∏úË•øÔºåÂ∞±ÊòØ‰ªéÂõæÂÉèÁä∂ÊÄÅË°®Ëø∞Âà∞ÂõæÂÉèÂºïÁî®ÁöÑÊò†Â∞ÑË°®„ÄÇÂÆÉÊèê‰æõ‰∫Ü‰∏Ä‰∏™‰πãÂâçÁöÑÂÜôÊ≥ï‰∏çÂÖ∑Â§áÁöÑÁâπÁÇπÔºåËÄåËøô‰∏™ÁâπÁÇπÊòØËææÊàêÂ§çÁî®ÁöÑÂøÖË¶ÅÂâçÊèêÔºöÂõæÂÉèÂ≠òÂèñÁöÑÊñπÂºèÊòØ <strong>Áªü‰∏ÄÁöÑ</strong>Ôºå<strong>ÊúâÈôêÁöÑ</strong>Ôºå‰ªéËÄåÊòØ <strong>ÂèØÂõ∫ÂåñÁöÑ</strong>„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> stateTagToImageMap = [<span class="type">String</span>:<span class="type">MyImage</span>]()</span><br></pre></td></tr></tbody></table></figure>
<p>Êàë‰ª¨Áî®‰∏Ä‰∏™ <strong>Â≠óÁ¨¶‰∏≤Ê†áÁ≠æ</strong> Êù•Ë°®Á§∫ÂõæÂÉèÁöÑÁä∂ÊÄÅ„ÄÇÂØπ‰∫éÂõæÂÉè ‚ÄúÁÆ°ÈÅì‚Äù ÁöÑ‰ΩøÁî®ËÄÖÊù•ËØ¥Ôºå‰ªñÂè™ÈúÄË¶ÅÁêÜËß£ÊØè‰∏™Ê†áÁ≠æÁöÑÂê´‰πâÔºåÈÄöËøáÊ†áÁ≠æÊù•Â≠òÂèñÂõæÂÉèÂπ∂ËøõË°åÂ§ÑÁêÜ„ÄÇÂú®Ëøô‰∫õÊ†áÁ≠æ‰∏≠ÔºåÊàë‰ª¨ÂÜçÊèêÁÇºÂá∫Âá†‰∏™ÂÖ∑ÊúâÈÄöÁî®Âê´‰πâÁöÑ‰ª£Ë°®ÊÄßÊ†áÁ≠æÔºöÊØîÂ¶ÇÔºå<code>original</code> ‰ª£Ë°® ‚Äú<strong>ÊúÄÂàùÁöÑ</strong>‚ÄùÔºå<code>processed</code> ‰ª£Ë°® ‚Äú<strong>Âä†Â∑•ÂÆåÊàêÁöÑ</strong>‚ÄùÔºåËøôÊ≠£ÊòØÂâçÊñáÊèêÂà∞ÁöÑ <strong>Âç†‰ΩçÁ¨¶</strong> „ÄÇÂÆπÊòìÁêÜËß£ÔºåÂú®‰∏Ä‰ªΩÂèØÂ§çÁî®ÁöÑ‰ª£Á†ÅÂ∫ì‰∏≠Ôºå‰Ω†ÂèØ‰ª•Â£∞ÊòéÂπ∂‰∏îÈ¢ÑÁΩÆËÆ∏Â§ö <strong>Âç†‰ΩçÁ¨¶</strong> „ÄÇ‰ΩÜ‰Ω†‰∏ç‰ºöÂú®Ëøô‰∏™‰ª£Á†ÅÂ∫ìÈáåÂ£∞ÊòéÂêåÊ†∑Êï∞ÈáèÁöÑÂõæÂÉèÂºïÁî® ‚Äî‚Äî ËøôÊ†∑ÂæàÂ•áÊÄ™ÂØπÂêßÔºüÂì™ÊÄï‰ªéÁ®ãÂ∫èÂÆûÁé∞ÁöÑËßíÂ∫¶Êù•ËØ¥ÔºåÊ≤°ÊúâÂàÜÈÖçÂÆûÈôÖÁ©∫Èó¥ÁöÑÂºïÁî®Âπ∂‰∏ç‰∏ÄÂÆö‰ºöÂç†ÊçÆÊõ¥Â§öÁöÑÂÜÖÂ≠ò„ÄÇÂú®ÂêéÈù¢Âàó‰∏æÁöÑ‰ª£Á†ÅËåÉ‰æã‰∏≠ÔºåÊàë‰ª¨Â∞Ü‰ºöÁªèÂ∏∏Âú∞Áî®Âà∞ <code>original</code> Âíå <code>processed</code> ËøôÊ†∑ÁöÑÊ†áÁ≠æ„ÄÇ</p>
<p>‰∏çÂ¶®ÈòÖËØª‰∏ãÈù¢ËøôÊÆµ‰ª£Á†ÅÔºåËøôÂ∞±ÊòØ‰∏ÄÁßç‰ΩøÁî®Ê†áÁ≠æÊù•Êìç‰ΩúÂØπÂ∫îÂõæÂÉèÁöÑÂÜôÊ≥ï„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ÊòæÁ§∫‰∏§‰∏™Â§ÑÁêÜÊ≠•È™§‰πãÂêéÁöÑÂõæÂÉè </span></span><br><span class="line">pipeline.from (.original) <span class="comment">// ‰ªéÂéüÂßãÁöÑÂõæÂÉèÂºÄÂßã </span></span><br><span class="line">        .copyTo (.processed) <span class="comment">// Êã∑Ë¥ùÂá∫‰∏Ä‰ªΩÂõæÂÉèÁî®‰∫éÂ§ÑÁêÜÔºåÂØπÂ∫îÊ†áÁ≠æ processed</span></span><br><span class="line">        .doProcess (tag: .processed, specificProcess1)  <span class="comment">// Âú® processed ‰∏äÊâßË°åÂ§ÑÁêÜ 1</span></span><br><span class="line">        .doProcess (tag: .processed, specificProcess2) <span class="comment">// Âú® processed ‰∏äÊâßË°åÂ§ÑÁêÜ 2</span></span><br><span class="line"></span><br><span class="line">showImage (pipeline.fetch (.processed)) <span class="comment">// ÂèñÂæó processed Ê†áÁ≠æ‰ª£Ë°®ÁöÑÂõæÂÉèÂπ∂‰∏îÂ±ïÁ§∫ </span></span><br></pre></td></tr></tbody></table></figure>
<h2 id="ÈîãÈù¢ÁöÑÂÆûÁé∞ÊñπÊ°àÂíåÊÑè‰πâ"><a href="#ÈîãÈù¢ÁöÑÂÆûÁé∞ÊñπÊ°àÂíåÊÑè‰πâ" class="headerlink" title="ÈîãÈù¢ÁöÑÂÆûÁé∞ÊñπÊ°àÂíåÊÑè‰πâ"></a>ÈîãÈù¢ÁöÑÂÆûÁé∞ÊñπÊ°àÂíåÊÑè‰πâ</h2><p>Ëß£ÂÜ≥‰∫Ü ‚ÄúËäÇÁÇπ‚Äù ÁöÑËÆæËÆ°ÔºåÊàë‰ª¨ÂÜçÊù•ÁúãÂü∫‰∫é ‚ÄúËäÇÁÇπ‚Äù ÊèêÁÇºÂá∫Êù•ÁöÑ ‚ÄúÈîãÈù¢‚Äù Ë¶ÅÊÄé‰πàËÆæËÆ°„ÄÇÂÆπÊòìÁêÜËß£Ôºå‚Äú<strong>ÈîãÈù¢</strong>‚Äù ÊòØÊúÄÂâçÈù¢ÁöÑÈÇ£‰∏™ ‚ÄúËäÇÁÇπ‚Äù ÔºåÂÖ∑Êúâ <strong>ÂîØ‰∏ÄÊÄß</strong>ÔºåÂØπÂ∫îÂÖ∑‰ΩìÁöÑÂõæÂÉèÂ§ÑÁêÜ‰ª£Á†Å‰∏≠Â∞±ÊòØ ‚ÄúÂΩìÂâçÊ≠£Âú®Ë¢´Â§ÑÁêÜÁöÑÈÇ£‰∏™ÂõæÂÉè‚Äù„ÄÇÂú®ËÆæËÆ°ÂõæÂÉèÁÆ°ÈÅìÂØπÂ§ñÊèê‰æõÁöÑÂ§ÑÁêÜ API Êó∂ÔºåÊàë‰ª¨Á∫¶ÂÆöÂ§ÑÁêÜÂä®‰Ωú‰∏ÄÂÆöÂè™ËÉΩÂèëÁîüÂú®Ëøô‰∏™ ‚Äú<strong>ÂΩìÂâçÁöÑ</strong>‚Äù ÂõæÂÉè‰∏äÔºåËøôÊ†∑Â∞±ËÉΩÂ§ü‰øùËØÅÊàë‰ª¨ÁöÑ ‚ÄúÂõæÂÉèÊµÅ‚Äù ÊÄªÊòØÊåâÁÖßÊàë‰ª¨ÊÉ≥Ë¶ÅÁöÑÊñπÂêëÊµÅÂä®ÔºåÂπ∂‰∏îÂú®Ëøô‰∏™ËøáÁ®ã‰∏≠Ôºå‚ÄúÂõæÂÉèÊµÅ‚Äù ÊòØ‰∏ç‰ºöË¢´ÁØ°ÊîπÁöÑ„ÄÇËøô‰πüÊòØÊàë‰ª¨ÁöÑÂõæÂÉèÁºñËæëÂäüËÉΩË¶ÅÂÆûÁé∞Êí§ÈîÄÂíåÈáçÂÅöÂäüËÉΩÁöÑÂü∫Êú¨ÂâçÊèê„ÄÇ</p>
<p>ËøòÊòØ‰∏äÈù¢ÈÇ£ÊÆµ‰ª£Á†ÅÔºåÁé∞Âú®ÂèØ‰ª•ÂéªÊéâÂÆûÈôÖÂ§ÑÁêÜÊ≠•È™§ÁöÑÊ†áÁ≠æÂèÇÊï∞„ÄÇÂõ†‰∏∫Êàë‰ª¨Á∫¶Êùü‰∫ÜÂ§ÑÁêÜÂè™ËÉΩÂèëÁîüÂú® <strong>ÂîØ‰∏ÄÁöÑ</strong>„ÄÅ<strong>ÂΩìÂâçÁöÑ</strong> ÂõæÂÉè‰∏ä„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ÊòæÁ§∫‰∏Ä‰∏™Â§ÑÁêÜÊ≠•È™§‰πãÂêéÁöÑÂõæÂÉè </span></span><br><span class="line">pipeline.from (.original) <span class="comment">// ‰ªéÂéüÂßãÁöÑÂõæÂÉèÂºÄÂßã </span></span><br><span class="line">        .copyTo (.processed) <span class="comment">// Êã∑Ë¥ùÂá∫‰∏Ä‰ªΩÂõæÂÉèÁî®‰∫éÂ§ÑÁêÜÔºåÂØπÂ∫îÊ†áÁ≠æ processed</span></span><br><span class="line">        .doProcess (specificProcess1) <span class="comment">// ÈöêÂê´‰∫ÜÂú® processed ‰∏äÊâßË°åÂ§ÑÁêÜ 1</span></span><br><span class="line">        .doProcess (specificProcess2) <span class="comment">// ÈöêÂê´‰∫ÜÂú® processed ‰∏äÊâßË°åÂ§ÑÁêÜ 2</span></span><br><span class="line"></span><br><span class="line">showImage (pipeline.fetch (.processed)) <span class="comment">// ÂèñÂæó processed Ê†áÁ≠æ‰ª£Ë°®ÁöÑÂõæÂÉèÂπ∂‰∏îÂ±ïÁ§∫ </span></span><br></pre></td></tr></tbody></table></figure>
<p>Â¶ÇÊûúË¶ÅÊ±ÇËÉΩÂ§üÂõûÊí§Âà∞Á¨¨‰∏Ä‰∏™Â§ÑÁêÜÊ≠•È™§‰πãÂêéÁöÑÁä∂ÊÄÅÔºåÂÜçÂÅöÁ¨¨‰∫å‰∏™Â§ÑÁêÜÊ≠•È™§ÔºåÂπ∂‰∏îÁ¨¨‰∫å‰∏™Â§ÑÁêÜÊ≠•È™§ÁöÑÂèÇÊï∞ÊòØÂèØ‰ª•ÊîπÂèòÁöÑ„ÄÇÂèØ‰ª•Ëøô‰πàÂÅöÔºö</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ÊòæÁ§∫‰∏Ä‰∏™Â§ÑÁêÜÊ≠•È™§‰πãÂêéÁöÑÂõæÂÉèÔºå‰ΩÜÊàë‰ª¨Âú®ËøáÁ®ã‰∏≠‰øùÁïô‰∫ÜÁ¨¨‰∏Ä‰∏™Ê≠•È™§ÁöÑÁä∂ÊÄÅ </span></span><br><span class="line">pipeline.from (.original)</span><br><span class="line">        .copyTo (<span class="string">"specificProcess1"</span>) <span class="comment">// Áõ∏ÊØî‰∏ÄÊ≠•Âà∞‰ΩçÔºåËøôÈáåÂ§öÂ≠òÂÇ®‰∫ÜÁ¨¨‰∏Ä‰∏™Ê≠•È™§ÁöÑÁä∂ÊÄÅ </span></span><br><span class="line">        .doProcess (specificProcess1)</span><br><span class="line">        .copyTo (.processed)</span><br><span class="line">        .doProcess (specificProcess2.setParams (params1))</span><br><span class="line"></span><br><span class="line">showImage (pipeline.fetch (.processed))</span><br><span class="line"></span><br><span class="line"><span class="comment">// Ë∞ÉÊï¥Á¨¨‰∫å‰∏™Ê≠•È™§ÁöÑÊüê‰∫õÂèÇÊï∞ÔºåÈáçÊñ∞ÊòæÁ§∫ÂõæÂÉè </span></span><br><span class="line">pipeline.from (<span class="string">"specificProcess1"</span>) <span class="comment">// ‰πãÂâçÂ≠òÂÇ®‰∫ÜÁ¨¨‰∏Ä‰∏™Ê≠•È™§ÁöÑÁä∂ÊÄÅÔºåÁõ¥Êé•‰ªéËøô‰∏™Ê≠•È™§ÂºÄÂßã </span></span><br><span class="line">        .copyTo (.processed)</span><br><span class="line">        .doProcess (specificProcess2.setParams (params2))</span><br><span class="line"></span><br><span class="line">showImage (pipeline.fetch (.processed))</span><br></pre></td></tr></tbody></table></figure>
<h2 id="ÊµÅÂä®ÂíåËøûÈÄöÊÄßÁöÑÂÆûÁé∞ÊñπÊ°à"><a href="#ÊµÅÂä®ÂíåËøûÈÄöÊÄßÁöÑÂÆûÁé∞ÊñπÊ°à" class="headerlink" title="ÊµÅÂä®ÂíåËøûÈÄöÊÄßÁöÑÂÆûÁé∞ÊñπÊ°à"></a>ÊµÅÂä®ÂíåËøûÈÄöÊÄßÁöÑÂÆûÁé∞ÊñπÊ°à</h2><p>Êúâ‰∫Ü ‚ÄúËäÇÁÇπ‚Äù Âíå ‚ÄúÈîãÈù¢‚ÄùÔºå‚ÄúÊµÅÂä®‚Äù Âíå ‚ÄúËøûÈÄö‚Äù Â∞±Êúâ‰∫Ü‰ΩúÁî®ÁöÑ‰∏ª‰Ωì„ÄÇÂØπÂ∫îÂà∞ÂõæÂÉèÁºñËæëÂäüËÉΩÔºå‚Äú<strong>ÊµÅÂä®</strong>‚Äù ÂÖ∂ÂÆûÂ∞±ÊòØÂõæÂÉè‰ªé‰∏Ä‰∏™Áä∂ÊÄÅÂèòÊàêÂè¶Â§ñ‰∏Ä‰∏™Áä∂ÊÄÅÁöÑËøáÁ®ã„ÄÇ‚Äú<strong>ËøûÈÄö</strong>‚Äù ÂàôÊõ¥Â•ΩÁêÜËß£Ôºå‰∏Ä‰∏™ÁÆ°ÈÅìÂá∫Êù•ÁöÑÂõæÂÉèÂèØ‰ª•Ë¢´Âè¶Â§ñ‰∏Ä‰∏™ÁÆ°ÈÅìÊé•Á∫≥ÔºåÁî±Ê≠§ÊûÑÊàêÁÆ°ÈÅì‰πãÈó¥ÁöÑËøûÊé•„ÄÇËøûÊé•Âú®‰∏ÄËµ∑ÁöÑÊØè‰∏ÄËäÇ ‚Äú<strong>Â∞èÁÆ°ÈÅì</strong>‚Äù ÂêÑÂè∏ÂÖ∂ËÅåÔºåÁÅµÊ¥ªÁªÑÂêàÔºåÂÜçÊûÑÊàêÊõ¥ÈïøË∑®Â∫¶ÁöÑ ‚Äú<strong>Â§ßÁÆ°ÈÅì</strong>‚Äù ÊàñËÄÖ ‚Äú<strong>ÁÆ°ÈÅìÁΩëÁªú</strong>‚ÄùÔºå‰ªéËÄåÂçèÂêåÂÆåÊàêÂ§çÊùÇÁöÑ‰∏öÂä°ÊµÅÁ®ã„ÄÇ</p>
<p>ÂõûÂΩíÂà∞‰ª£Á†ÅÔºåÊàë‰ª¨Êù•Áúã‰∏ÄÁªÑÊ≠•È™§Á®çÂ§öÁöÑÂõæÁâáÂ§ÑÁêÜÂ∑•Â∫èÔºåÁúãÂÆÉÊòØÂ¶Ç‰Ωï‰ΩìÁé∞Âá∫ÁÆ°ÈÅìÁöÑ ‚ÄúÊµÅÂä®ÊÄß‚Äù Âíå ‚ÄúËøûÈÄöÊÄß‚Äù„ÄÇÂà®ÂéªÂÜÖÈÉ®ÁöÑÂÆûÁé∞ÁªÜËäÇÔºåÊï¥ÂêàÊàñËÄÖÂøΩÁï•‰∏Ä‰∫õ‰∏éÁÆ°ÈÅìËÆæËÆ°ÊÄùÊÉ≥ÂÖ≥ËÅî‰∏çÂ§ßÁöÑÈÄªËæëÔºå‰ª•‰∏ã‰ª£Á†ÅÂú®ÊµÅÁ®ã‰∏äÁÆóÊòØÊØîËæÉÊé•ËøëÂÆûÈôÖÁîü‰∫ßÁéØÂ¢É‰∫Ü„ÄÇËôΩÁÑ∂ÈááÁî®ÁöÑÊòØ‰º™‰ª£Á†ÅÔºåÁõ∏‰ø°ËØªËÄÖÂèØ‰ª•ÁúãÊáÇ„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** ‰∏ªÂäüËÉΩÂå∫Ôºå‰∏çÂ¶®Â∞ÜÂÆÉÁöÑ‰æãÁ®ãÁß∞‰∏∫ Main</span></span><br><span class="line"><span class="comment"> * Âü∫Êú¨ÂäüËÉΩÔºö</span></span><br><span class="line"><span class="comment"> * 1. Â±ïÁ§∫ÂõæÂÉè </span></span><br><span class="line"><span class="comment"> * 2. ÂèØ‰ª•‰ªéËøôÈáåËøõÂÖ•ÂêÑÂ≠êÂäüËÉΩÂ§ÑÁêÜÂõæÁâáÂÜçÂõûÂà∞ËøôÈáåÂ±ïÁ§∫Êñ∞ÁöÑÂõæÁâá </span></span><br><span class="line"><span class="comment"> * 3. Êí§ÈîÄÂà∞ÁªèËøáÊüê‰∏™Ê≠•È™§Â§ÑÁêÜ‰πãÂâçÁöÑÂõæÂÉèÊàñËÄÖÈáçÂÅöÂá∫‰πãÂâçÂÅöËøá‰ΩÜÊòØË¢´Êí§ÈîÄÊéâÁöÑÊüê‰∏™Ê≠•È™§ÁöÑÂõæÂÉè   </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">RoutineMain</span>.startFrom (imageFile) {</span><br><span class="line">    <span class="type">RoutineMain</span>.pipeline.loadFrom (imageFile, .original) <span class="comment">// ‰ªéÂõæÁâá‰∏≠Âä†ËΩΩÂàùÂßãÁöÑÂõæÂÉè </span></span><br><span class="line">}</span><br><span class="line"><span class="type">RoutineMain</span>.showCurrent () {</span><br><span class="line">    showImage (<span class="type">RoutineMain</span>.pipeline.front () <span class="comment">// ÊòæÁ§∫ ‚ÄúÈîãÈù¢‚Äù</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/** ËøõÂÖ•Âà∞‰∏Ä‰∏™Âè´ ‚ÄúÁæéÂûã‚Äù ÁöÑÂäüËÉΩÂå∫ÔºåÂØπÂ∫îÁöÑ‰æãÁ®ãÁß∞‰∏∫ FaceLift</span></span><br><span class="line"><span class="comment"> * Âü∫Êú¨ÂäüËÉΩÔºö</span></span><br><span class="line"><span class="comment"> * 1. Â±ïÁ§∫ÂõæÂÉè </span></span><br><span class="line"><span class="comment"> * 2. ÈíàÂØπÂõæÂÉè‰∏≠ÁöÑ‰∫∫ËÑ∏ËΩÆÂªìÔºå‰∫îÂÆòËøõË°åÂΩ¢Áä∂Ë∞ÉÊï¥ </span></span><br><span class="line"><span class="comment"> * 3. ËæìÂá∫Â§ÑÁêÜÂêéÁöÑÂõæÂÉèÂà∞‰∏ªÂäüËÉΩÂå∫ </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">RoutineFaceLift</span>.startFrom (<span class="type">RoutineMain</span>.pipeline.front ().copy ())</span><br><span class="line"><span class="type">RoutineFaceLift</span>.process () {</span><br><span class="line">    <span class="type">RoutineFaceLift</span>.pipeline</span><br><span class="line">         <span class="comment">// Ëøô‰∏™ËøáÁ®ãÁî®Êà∑Êó†Ê≥ïÂπ≤È¢ÑÔºå‰∏ç‰ºöÊúâ ‚ÄúÈáçÂÅö‚ÄùÔºåÂõ†Ê≠§Êàë‰ª¨ÂèØ‰ª•Áõ¥Êé•Âú®ÂéüÁ®ø‰∏äÊìç‰Ωú </span></span><br><span class="line">        .from (.original)</span><br><span class="line">        .doProcess (faceLift_step_1_process)</span><br><span class="line">        .doProcess (faceLift_step_2_process)</span><br><span class="line">        .doProcess (faceLift_step_3_process)</span><br><span class="line">        ...</span><br><span class="line">}</span><br><span class="line"><span class="comment">// ÊääÂ≠êÂäüËÉΩ ‚ÄúÁæéÂûã‚Äù Â§ÑÁêÜÂ•ΩÁöÑÂõæÂÉèÊèê‰∫§Áªô‰∏ªÂäüËÉΩ </span></span><br><span class="line"><span class="type">RoutineMain</span>.accept (<span class="type">RoutineFaceLift</span>.commit ())</span><br><span class="line"></span><br><span class="line"><span class="comment">/** ËøõÂÖ•Âà∞‰∏Ä‰∏™Âè´ ‚ÄúÊª§Èïú‚Äù ÁöÑÂäüËÉΩÂå∫ÔºåÂØπÂ∫îÁöÑ‰æãÁ®ãÁß∞‰∏∫ Filter</span></span><br><span class="line"><span class="comment"> * Âü∫Êú¨ÂäüËÉΩÔºö</span></span><br><span class="line"><span class="comment"> * 1. Â±ïÁ§∫ÂõæÂÉè </span></span><br><span class="line"><span class="comment"> * 2. Êª§ÈïúÂåñÂ§ÑÁêÜÂõæÂÉè </span></span><br><span class="line"><span class="comment"> * 3. ËæìÂá∫Â§ÑÁêÜÂêéÁöÑÂõæÂÉèÂà∞‰∏ªÂäüËÉΩÂå∫ </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">RoutineFilter</span>.startFrom (<span class="type">RoutineMain</span>.pipeline.front ().copy ());</span><br><span class="line"><span class="type">RoutineFilter</span>.process () {</span><br><span class="line">    <span class="type">RoutineFilter</span>.pipeline</span><br><span class="line">        <span class="comment">// Ëøô‰∏™ËøáÁ®ã‰∏≠Áî®Êà∑ÂÜ≥ÂÆöË¶ÅÈÄâÁî®Âì™‰∏™ÂÖ∑‰ΩìÁöÑÊª§ÈïúÔºåÂõ†Ê≠§ÊØèÊ¨°ÈÉΩÈúÄË¶ÅÂü∫‰∫éÂéüÁ®øÂ§çÂà∂‰∏Ä‰ªΩÂÜçÊª§ÈïúÂåñ </span></span><br><span class="line">        .from (.original).copyTo (.processed)</span><br><span class="line">        .doProcess (filterProcess (pickFilter (<span class="string">"awful"</span>)))</span><br><span class="line">        ... <span class="comment">// Áö±ÁúâÔºåËøô‰∏™‰∏çÂ•ΩÔºåÊç¢‰∏Ä‰∏™ÔºÅ</span></span><br><span class="line">        .from (.original).copyTo (.processed)</span><br><span class="line">        .doProcess (filterProcess (pickFilter (<span class="string">"notbad"</span>)))</span><br><span class="line">        ... <span class="comment">// ÊâòËÖÆÔºåËøô‰∏™ËøòË°åÔºåÂÜçÊç¢‰∏™ËØïËØïÔΩû</span></span><br><span class="line">        .from (.original).copyTo (.processed)</span><br><span class="line">        .doProcess (filterProcess (pickFilter (<span class="string">"perfect"</span>)))</span><br><span class="line">        ... <span class="comment">// ÂÆåÁæéÔΩû</span></span><br><span class="line">        ...</span><br><span class="line">}</span><br><span class="line"><span class="comment">// ÊääÂ≠êÂäüËÉΩ ‚ÄúÊª§Èïú‚Äù Â§ÑÁêÜÂ•ΩÁöÑÂõæÂÉèÊèê‰∫§Áªô‰∏ªÂäüËÉΩ </span></span><br><span class="line"><span class="type">RoutineMain</span>.accept (<span class="type">RoutineFilter</span>.commit ())</span><br><span class="line"></span><br><span class="line"><span class="comment">/** ËøõÂÖ•Âà∞‰∏Ä‰∏™Âè´ ‚ÄúÁæéÈ¢ú ‚Äù ÁöÑÂäüËÉΩÂå∫ÔºåÂØπÂ∫îÁöÑ‰æãÁ®ãÁß∞‰∏∫ SkinBeauty</span></span><br><span class="line"><span class="comment"> * Âü∫Êú¨ÂäüËÉΩÔºö</span></span><br><span class="line"><span class="comment"> * 1. Â±ïÁ§∫ÂõæÂÉè </span></span><br><span class="line"><span class="comment"> * 2. ÈíàÂØπÂõæÂÉè‰∏≠ÁöÑ‰∫∫ËÑ∏ÁöÆËÇ§ËøõË°åËâ≤Áõ∏Ë∞ÉÊï¥ </span></span><br><span class="line"><span class="comment"> * 3. ËæìÂá∫Â§ÑÁêÜÂêéÁöÑÂõæÂÉèÁªô Main ÂäüËÉΩ </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">RoutineSkinBeauty</span>.startFrom (<span class="type">RoutineMain</span>.pipeline.front ().copy ());</span><br><span class="line"><span class="type">RoutineSkinBeauty</span>.process () {</span><br><span class="line">    <span class="type">RoutineSkinBeauty</span>.pipeline</span><br><span class="line">        <span class="comment">// Ëøô‰∏™ËøáÁ®ãÁî®Êà∑ÂèØ‰ª•Ë∞ÉËäÇ‰∏Ä‰∏™ÊªëÁ´øÊù•ÊéßÂà∂Ëâ≤Áõ∏ÂèÇÊï∞ÔºåÊØèÊ¨°ÈÉΩÂü∫‰∫éÂéüÁ®øÂ§çÂà∂‰∏Ä‰ªΩÂÜçË∞ÉËâ≤Áõ∏ </span></span><br><span class="line">        .from (.original).copyTo (.processed)</span><br><span class="line">        .doProcess (skinBeautyProcess (level_too_weak))</span><br><span class="line">        ... <span class="comment">// ÊâòËÖÆÔºåÊïàÊûúÂ•ΩÂÉè‰∏çÊòéÊòæÔºåÂä†Âº∫‰∏ÄÁÇπ </span></span><br><span class="line">        .from (.original).copyTo (.processed)</span><br><span class="line">        .doProcess (skinBeautyProcess (level_too_much)))</span><br><span class="line">        ... <span class="comment">// Áö±ÁúâÔºåÂ•ΩÂÉèÊúâÁÇπËøáÂ§¥‰∫ÜÔºåÂæÄÂõûË∞É‰∏ÄÁÇπ </span></span><br><span class="line">        .from (.original).copyTo (.processed)</span><br><span class="line">        .doProcess (skinBeautyProcess (level_just_right)</span><br><span class="line">        ... <span class="comment">// ÂÆåÁæéÔΩû</span></span><br><span class="line">        ...</span><br><span class="line">}</span><br><span class="line"><span class="comment">// ÊääÂ≠êÂäüËÉΩ ‚ÄúÁæéÈ¢ú‚Äù Â§ÑÁêÜÂ•ΩÁöÑÂõæÂÉèÊèê‰∫§Áªô‰∏ªÂäüËÉΩ </span></span><br><span class="line"><span class="type">RoutineMain</span>.accept (<span class="type">RoutineSkinBeauty</span>.commit ())</span><br><span class="line"></span><br><span class="line"><span class="comment">// Á∫†Áªì‰∏Ä‰∏ã„ÄÇ„ÄÇ</span></span><br><span class="line"><span class="comment">// ÁäπË±´ÔºåË¶Å‰∏çËøòÊòØ‰∏çÁæéÈ¢ú‰∫ÜÂêßÔºü</span></span><br><span class="line"><span class="type">RoutineMain</span>.undo ();</span><br><span class="line"><span class="comment">// ËøüÁñëÔºåÊª§Èïú‰πü‰∏çË¶Å‰∫ÜÔºü</span></span><br><span class="line"><span class="type">RoutineMain</span>.undo ();</span><br><span class="line"><span class="comment">// ÊÄùËÄÉ‰∏≠„ÄÇ„ÄÇ„ÄÇ</span></span><br><span class="line"><span class="comment">//... ‰∏çË°åÔºåËøòÊòØÈÉΩÂä†ÂõûÊù•Âêß </span></span><br><span class="line"><span class="type">RoutineMain</span>.redo ().redo ();</span><br><span class="line"><span class="comment">// Á´ØËØ¶ 5 ÂàÜÈíü„ÄÇ„ÄÇ„ÄÇÂÆåÁæéÔΩû</span></span><br><span class="line">save (); <span class="comment">// Êî∂Â∑•ÔºåÂáÜÂ§áÂèëÊúãÂèãÂúà </span></span><br></pre></td></tr></tbody></table></figure>
<h1 id="ÊÄªÁªì"><a href="#ÊÄªÁªì" class="headerlink" title="ÊÄªÁªì"></a>ÊÄªÁªì</h1><p>ÂÖ≥‰∫é ‚ÄúÁÆ°ÈÅì‚Äù ÁöÑËÆæËÆ°ÊÄùË∑ØÂíåÂÆûÁé∞ÊñπÊ°à‰ªãÁªçÂà∞Ê≠§„ÄÇÊàë‰ª¨ÂèØ‰ª•ÂõûÈ°æ‰∏Ä‰∏ãÔºåÊú¨ÊñáÂºÄÂßãÊâÄÊèêÂà∞ ‚ÄúÈªëÁõíÂ≠ê‚Äù ËÆæËÆ°ÁöÑÁ¨¨‰∫å‰∏™ÈóÆÈ¢òÔºö‚ÄúÂõæÂÉè <strong><em>ÁÆ°ÁêÜ</em></strong>  ÂíåÂõæÂÉè <strong><em>ÊïàÊûúÂ§ÑÁêÜ</em></strong>  Ë¢´ÁªëÂÆöÂú®‰∏ÄËµ∑„ÄÇ‚ÄùÔºåÂú®ÁÆ°ÈÅìÊñπÊ°à‰∏≠ÊòØ‰∏çÊòØÂ∑≤ÁªèËß£ÂÜ≥‰∫ÜÂë¢Ôºü</p>
<blockquote>
<p>‚ÄúÁÆ°ÈÅì‚Äù ËÆæËÆ°ÁöÑÂü∫Áü≥ÊòØ <strong>Êó†Â∑ÆÂà´Âú∞ÁÆ°ÁêÜÂõæÂÉè</strong> ÔºåË¢´ÁÆ°ÁêÜÁöÑÊØè‰∏Ä‰∏™ÂõæÂÉèÔºåÁî±ÊúÄÂàùÂ∞ÜÂÖ∂ÊäïÂÖ•ÁÆ°ÈÅìÁöÑÂàõÂª∫ËÄÖ‰∏∫ÂÖ∂ÂÆö‰πâÊ†áÁ≠æ„ÄÇÊúÄÂàùÁöÑÂàõÂª∫ËÄÖÂíåÂêéÊù•ÁöÑÂçèÂêåËÄÖÔºåÂè™ÈúÄË¶ÅÂØπËøô‰∏™Ê†áÁ≠æÁöÑÂê´‰πâËææÊàê <strong>ÂÖ±ËØÜ</strong> ‰æøÂèØ‰ª•ËøõË°åÂçè‰Ωú„ÄÇ‚ÄúÁÆ°ÈÅì‚Äù ÁöÑÊÄùÊÉ≥ÊòØÊ®°Êãü ‚Äú<strong>ÊµÅ‰Ωì</strong>‚Äù ÁöÑËøêË°åÊñπÂºèÊù•ÂÆûÁé∞ÂõæÂÉèÂ§ÑÁêÜËøáÁ®ãÔºåÈÄöËøá ‚Äú<strong>ËäÇÁÇπ</strong>‚Äù ÁöÑËÆæÂÆöÊù• <strong>ÂàÜËß£</strong> Â§ÑÁêÜÊ≠•È™§ÔºåÈÄöËøá ‚Äú<strong>ÈîãÈù¢</strong>‚Äù ÁöÑÊìçÊéßÊù• <strong>ËÅöÁÑ¶</strong> ÊØè‰∏™ÂçïÊ≠•ÁöÑÊìç‰ΩúÔºåÈÄöËøá <strong>ËøûÈÄöÊÄß</strong> Êù•Â∞Ü <strong>ÂàÜÊ≤ª</strong> ÁöÑÈÄªËæëÈáçÊñ∞ <strong>‰∏≤ËÅî</strong> Ëµ∑Êù•ÂÆåÊàêÂ§çÊùÇÁöÑÂäüËÉΩ„ÄÇ</p>
</blockquote>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://theinfinitegame.tech/development/note-swiftui-mvvm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Áå´ÂÖãÊùØ">
      <meta itemprop="description" content="Stay hungry, stay foolish.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="The Infinite Game">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/development/note-swiftui-mvvm/" class="post-title-link" itemprop="url">SwiftUI Á¨îËÆ∞ | MVVM In SwiftUI</a>
        </h1>

        <div class="post-meta">

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">ÂèëË°®‰∫é</span>

              <time title="ÂàõÂª∫Êó∂Èó¥Ôºö2020-03-02 10:51:18" itemprop="dateCreated datePublished" datetime="2020-03-02T10:51:18+08:00">2020-03-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">ÂàÜÁ±ª‰∫é</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/development/" itemprop="url" rel="index">
                    <span itemprop="name">development</span>
                  </a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="Êú¨ÊñáÂ≠óÊï∞">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">Êú¨ÊñáÂ≠óÊï∞Ôºö</span>
              <span>6.2k</span>
            </span>
            <span class="post-meta-item" title="ÈòÖËØªÊó∂Èïø">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">ÈòÖËØªÊó∂Èïø &asymp;</span>
              <span>6 ÂàÜÈíü</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>ËØëËá™ <a href="https://augmentedcode.io/2020/01/05/mvvm-in-swiftui/" target="_blank" rel="noopener">MVVM in SwiftUI</a></p>
</blockquote>
<p>ËÆ©Êàë‰ª¨Áî® MVVM (model-view-view model) Êù•ÊûÑÂª∫‰∏Ä‰∏™Â∫îÁî®ÔºåÂÖ∂‰∏≠ÁöÑÊØè‰∏™ SwiftUI ËßÜÂõæÈÉΩÊúâËá™Â∑±ÁöÑ model „ÄÇËøô‰ºöÊòØ‰∏Ä‰∏™Êã•Êúâ‰∏§‰∏™ËßÜÂõæÁöÑ app : ‰∏Ä‰∏™ÁîµÂΩ±ÂàóË°®‰ª•Âèä‰∏Ä‰∏™Áî®‰∫éÊ∑ªÂä†ÁîµÂΩ±ÁöÑË°®Âçï„ÄÇÊñ∞Â¢ûÁöÑÁîµÂΩ±Â≠òÂú®Âú® <code>MovieStore</code> ÔºåÂÆÉÁî±‰∏§‰∏™ view models ÂÖ±‰∫´„ÄÇÊàë‰ª¨Â∞ÜÈÄöËøá environment Êù•ÂÖ±‰∫´ MovieStore Ôºå‰πüÂ∞±ËØ¥ÔºåÂΩìÊàë‰ª¨ÈúÄË¶ÅÊó∂Ôºå‰ºö‰ªé environment ‰∏≠ËØªÂèñ„ÄÇ</p>
<h2 id="Áî®-Movie-Âíå-MovieStore-Êù•Ë°®Á§∫Êï∞ÊçÆ"><a href="#Áî®-Movie-Âíå-MovieStore-Êù•Ë°®Á§∫Êï∞ÊçÆ" class="headerlink" title="Áî® Movie Âíå MovieStore Êù•Ë°®Á§∫Êï∞ÊçÆ"></a>Áî® Movie Âíå MovieStore Êù•Ë°®Á§∫Êï∞ÊçÆ</h2><p>Movie ÊòØ‰∏Ä‰∏™ÂæàÂ∞èÁöÑÁªìÊûÑ‰ΩìÔºåÂè™Â≠òÂÇ®‰∫ÜÊ†áÈ¢òÂíåËØÑÂàÜ„ÄÇÊ†áÈ¢òÂíåËØÑÂàÜÈÉΩÊòØÂèØÂèòÁöÑÔºåÂõ†‰∏∫Êàë‰ª¨ÈúÄË¶ÅÂú® AddMovieView ÈáåÊõ¥Êñ∞ÂÆÉ‰ª¨„ÄÇËøô‰∏™ÁªìÊûÑ‰Ωì‰πüÈÅµÂæ™ <code>Identifiable</code> ÂçèËÆÆÔºåÂõ†‰∏∫Êàë‰ª¨Â∞ÜÁî® List ËßÜÂõæÊù•Â±ïÁ§∫ÊâÄÊúâÁöÑÁîµÂΩ±„ÄÇList ÈúÄË¶ÅËÉΩÂ§üÊ†áËØÜÂÜÖÂÆπ‰∏≠ÁöÑÊØè‰∏ÄÈ°πÔºåËÄåÈÅµÂæ™Ëøô‰∏™ÂçèËÆÆÊòØÊúÄÁÆÄÂçïÁöÑÊñπÂºè„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Movie</span>: <span class="title">Equatable</span>, <span class="title">Identifiable</span> </span>{</span><br><span class="line">    <span class="keyword">let</span> id = <span class="type">UUID</span>()</span><br><span class="line">    <span class="keyword">var</span> fullTitle: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> givenRating: <span class="type">Rating</span> = .notSeen</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Movie</span> </span>{</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">Rating</span>: <span class="title">Int</span>, <span class="title">CaseIterable</span> </span>{</span><br><span class="line">        <span class="keyword">case</span> notSeen, terrible, poor, decent, good, excellent</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>MovieStore ‰πüÂæàÁÆÄÂçïÔºå‰∏çËøáÂÆûÈôÖÁöÑ app ‰ºöÂåÖÂê´Êõ¥Â§öÁöÑÈÄªËæëÔºöÊåÅ‰πÖÂåñÔºåÂà†Èô§Á≠âÁ≠â„ÄÇÊàë‰ª¨Áî® <code>Published</code> Â±ûÊÄßÂåÖË£ÖÂô®Êù•‰∏∫ËÆ¢ÈòÖËÄÖËá™Âä®Êèê‰æõÂèëÂ∏É„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">MovieStore</span> </span>{</span><br><span class="line">    @<span class="type">Published</span> <span class="keyword">private</span>(<span class="keyword">set</span>) <span class="keyword">var</span> allMovies = [<span class="type">Movie</span>]()</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">(<span class="number">_</span> movie: Movie)</span></span> {</span><br><span class="line">        allMovies.append (movie)</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>‰∏∫‰∫ÜÂ∞ÜÂÖ±‰∫´ÁöÑ <code>MovieStore</code> ÊèíÂÖ•ÁéØÂ¢ÉÔºåÊàë‰ª¨ÈúÄË¶Å‰ΩøÁî®Ëá™ÂÆö‰πâÁöÑ EnvironmentKey „ÄÇËá™ÂÆö‰πâ key ‰ªÖ‰ªÖÂè™ÊòØ‰∏Ä‰∏™ÈÅµÂæ™  <code>EnvironmentKey</code> ÂçèËÆÆÁöÑËá™ÂÆö‰πâ key „ÄÇÊàë‰ª¨ÈúÄË¶ÅÊèê‰æõÁ±ªÂûãÂíåÈªòËÆ§ÂÄº„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MovieStoreKey</span>: <span class="title">EnvironmentKey</span> </span>{</span><br><span class="line">    <span class="keyword">typealias</span> <span class="type">Value</span> = <span class="type">MovieStore</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> defaultValue = <span class="type">MovieStore</span>()</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">EnvironmentValues</span> </span>{</span><br><span class="line">    <span class="keyword">var</span> movieStore: <span class="type">MovieStore</span> {</span><br><span class="line">        <span class="keyword">get</span> {</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">self</span>[<span class="type">MovieStoreKey</span>]</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">set</span> {</span><br><span class="line">            <span class="keyword">self</span>[<span class="type">MovieStoreKey</span>] = newValue</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Â¶ÇÊûúÊàë‰ª¨‰∏çÊèíÂÖ•Ëá™Â∑±ÁöÑ <code>MovieStore</code> ÂÆû‰æãÂà∞ environment ÔºåÈÇ£Â∞±‰ºö‰ΩøÁî® defaultValue ÈªòËÆ§ÂÄº„ÄÇÂÖ∏ÂûãÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨‰ºöÂú®ËßÜÂõæ‰ΩìÁ≥ª‰πãÂ§ñÂàùÂßãÂåñËøô‰∏™ÁâπÂÆöÂÆû‰æã„ÄÇ</p>
<h2 id="SceneDelegate-Âíå-MovieScene-ÂëàÁé∞"><a href="#SceneDelegate-Âíå-MovieScene-ÂëàÁé∞" class="headerlink" title="SceneDelegate Âíå MovieScene ÂëàÁé∞"></a>SceneDelegate Âíå MovieScene ÂëàÁé∞</h2><p>MovieStore ‰Ωú‰∏∫‰æùËµñÈ°πÔºåÂú®ÊûÑÈÄ†ÂáΩÊï∞Ë¢´‰º†Áªô view model „ÄÇÊàë‰ª¨Â∞Ü‰ΩøÁî®Â≠òÂÇ®Âú® SceneDelegate ÁöÑÂÆû‰æã„ÄÇÂÜçÊ¨°Áî≥ÊòéÔºåÂú®ÂÆûÈôÖÁöÑ app ‰∏≠ÔºåËøôÁßç‰æùËµñÈ°πÂæàÂèØËÉΩÊòØÂ§Ñ‰∫é‰∏Ä‰∏™Áã¨Á´ãÁöÑÂÆπÂô®ÊàñËÄÖÂà´ÁöÑÁ±ª‰ººÁöÑ‰∏úË•ø„ÄÇ MovieListView ÊòØÊàë‰ª¨Ë¶ÅÂëàÁé∞ÁöÑÁ¨¨‰∏Ä‰∏™ËßÜÂõæÔºåÂõ†Ê≠§Êàë‰ª¨‰ºöÂàùÂßãÂåñ view model Ôºå view ÔºåÂπ∂‰∏îÊèíÂÖ• MovieStore ÂÆû‰æãÂà∞ environment Ôºå‰ª•‰æøÂêéÁª≠‰ΩøÁî®„ÄÇ (movieStore keypath ÊòØÈÄöËøá EnvironmentValues ÁöÑ extension Êù•ÂÆö‰πâÁöÑ)„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">SceneDelegate</span>: <span class="title">UIResponder</span>, <span class="title">UIWindowSceneDelegate</span> </span>{</span><br><span class="line">    <span class="keyword">var</span> window: <span class="type">UIWindow?</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> movieStore = <span class="type">MovieStore</span>()</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">scene</span><span class="params">(<span class="number">_</span> scene: UIScene, willConnectTo session: UISceneSession, options connectionOptions: UIScene.ConnectionOptions)</span></span> {</span><br><span class="line">        <span class="keyword">let</span> viewModel = <span class="type">MovieListView</span>.<span class="type">ViewModel</span>(movieStore: movieStore)</span><br><span class="line">        <span class="keyword">let</span> contentView = <span class="type">MovieListView</span>(viewModel: viewModel).environment (\.movieStore, movieStore)</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> windowScene = scene <span class="keyword">as</span>? <span class="type">UIWindowScene</span> <span class="keyword">else</span> { <span class="keyword">return</span> }</span><br><span class="line">        <span class="keyword">let</span> window = <span class="type">UIWindow</span>(windowScene: windowScene)</span><br><span class="line">        window.rootViewController = <span class="type">UIHostingController</span>(rootView: contentView)</span><br><span class="line">        <span class="keyword">self</span>.window = window</span><br><span class="line">        window.makeKeyAndVisible ()</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="MovieListView-ÂíåÂØπÂ∫îÁöÑ-ViewModel"><a href="#MovieListView-ÂíåÂØπÂ∫îÁöÑ-ViewModel" class="headerlink" title="MovieListView ÂíåÂØπÂ∫îÁöÑ ViewModel"></a>MovieListView ÂíåÂØπÂ∫îÁöÑ ViewModel</h2><p>Âú® SwiftUI ‰∏≠Ôºåview model ÈÅµÂæ™ <code>ObservableObject</code> ÂçèËÆÆÔºå‰ΩøÁî® @Published Â±ûÊÄßÂåÖË£ÖÂô®„ÄÇ ObservableObject ÁöÑÈªòËÆ§ÂÆûÁé∞Êèê‰æõ‰∫Ü <code>objectWillChange</code> publisher „ÄÇ @Published Â±ûÊÄßÂåÖË£ÖÂô®ËÉΩÂú®Â±ûÊÄßÂ∞ÜË¶ÅÊîπÂèòÊó∂Ëá™Âä®ÂèëÂ∞ÑËøô‰∏™ publisher „ÄÇÂú® MovieListView ‰∏≠ÔºåÊàë‰ª¨Áî® @ObservedObject Â±ûÊÄßÂåÖË£ÖÂô®Â£∞Êòé view model Â±ûÊÄß„ÄÇËøô‰ºö‰ΩøÂæóËØ•ËßÜÂõæËÆ¢ÈòÖ objectWillChange publisher ÔºåÂπ∂‰∏îÂú® objectWillChange ÂèëÂä®Êó∂Ëá™Âä®Âà∑Êñ∞ËßÜÂõæ„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">MovieListView</span> </span>{</span><br><span class="line">    <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewModel</span>: <span class="title">ObservableObject</span> </span>{</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">let</span> movieStore: <span class="type">MovieStore</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">var</span> cancellables = [<span class="type">AnyCancellable</span>]()</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">init</span>(movieStore: <span class="type">MovieStore</span>) {</span><br><span class="line">            <span class="keyword">self</span>.movieStore = movieStore</span><br><span class="line">            cancellables.append (movieStore.$allMovies.assign (to: \.movies, on: <span class="keyword">self</span>))</span><br><span class="line">        }</span><br><span class="line">         </span><br><span class="line">        @<span class="type">Published</span> <span class="keyword">private</span>(<span class="keyword">set</span>) <span class="keyword">var</span> movies = [<span class="type">Movie</span>]()</span><br><span class="line">        @<span class="type">Published</span> <span class="keyword">var</span> isPresentingAddMovie = <span class="literal">false</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MovieListView</span>: <span class="title">View</span> </span>{</span><br><span class="line">    @<span class="type">Environment</span>(\.<span class="keyword">self</span>) <span class="keyword">var</span> environment</span><br><span class="line">    @<span class="type">ObservedObject</span> <span class="keyword">var</span> viewModel: <span class="type">ViewModel</span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> {</span><br><span class="line">        <span class="type">NavigationView</span> {</span><br><span class="line">            <span class="type">List</span>(<span class="keyword">self</span>.viewModel.movies) { movie <span class="keyword">in</span></span><br><span class="line">                <span class="type">Text</span>(movie.fullTitle)</span><br><span class="line">            }.navigationBarTitle (<span class="string">"Movies"</span>)</span><br><span class="line">                .navigationBarItems (trailing: navigationBarTrailingItem)</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> navigationBarTrailingItem: some <span class="type">View</span> {</span><br><span class="line">        <span class="type">Button</span>(action: {</span><br><span class="line">            <span class="keyword">self</span>.viewModel.isPresentingAddMovie = <span class="literal">true</span></span><br><span class="line">        }, label: {</span><br><span class="line">            <span class="type">Image</span>(systemName: <span class="string">"plus"</span>).frame (minWidth: <span class="number">32</span>, minHeight: <span class="number">32</span>)</span><br><span class="line">        }).sheet (isPresented: <span class="keyword">self</span>.$viewModel.isPresentingAddMovie) {</span><br><span class="line">            <span class="keyword">self</span>.makeAddMovieView ()</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">makeAddMovieView</span><span class="params">()</span></span> -&gt; <span class="type">AddMovieView</span> {</span><br><span class="line">        <span class="keyword">let</span> movieStore = environment [<span class="type">MovieStoreKey</span>]</span><br><span class="line">        <span class="keyword">let</span> viewModel = <span class="type">AddMovieView</span>.<span class="type">ViewModel</span>(movieStore: movieStore)</span><br><span class="line">        <span class="keyword">return</span> <span class="type">AddMovieView</span>(viewModel: viewModel)</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>‰Ω†‰ºöÊ≥®ÊÑèÂà∞ÔºåMovieStore Êó∂Áî®‰∫Ü‰∏§‰ªΩÔºå‰∏Ä‰ªΩÂú® view model ‰∏≠Ôºå‰∏Ä‰ªΩÊîæÂú®ÁéØÂ¢É‰∏≠„ÄÇ</p>
<p><code>AddMovieView</code> ÂíåÂÆÉÁöÑ view model ÊòØÂú®Áî®Êà∑ÁÇπÂáªÂØºËà™Ê†è‰∏äÁöÑÂä†Âè∑ÊåâÈíÆÊó∂Ë¢´ÂàõÂª∫ÁöÑ„ÄÇÁéØÂ¢ÉÂ±ûÊÄßÂåÖË£ÖÂô®ÂèØ‰ª•Ë¢´Áî®‰∫éËé∑ÂèñÊï¥‰∏™ÁéØÂ¢ÉÊàñËÄÖÂÄüÂä©ÁâπÂÆöÈîÆËé∑ÂèñÊüê‰∏™ÂÄº„ÄÇÂú®Ëøô‰∏™Ê°à‰æã‰∏≠Êàë‰ª¨ËÆøÈóÆ‰∫ÜÊï¥‰∏™ÁéØÂ¢ÉÂØπË±°ÔºåÁÑ∂ÂêéÂú®ÈúÄË¶ÅÁöÑÊó∂ÂÄôÂÄüÂä© MovieStoreKey ËÆøÈóÆ MovieStore „ÄÇÊàñËÄÖ‰Ω†‰πüÂèØ‰ª•‰ΩøÁî® @Environment (.movieStore) var movieStore Êù•‰ª£Êõø„ÄÇ</p>
<h2 id="AddMovieView-ÂíåÂØπÂ∫îÁöÑ-ViewModel"><a href="#AddMovieView-ÂíåÂØπÂ∫îÁöÑ-ViewModel" class="headerlink" title="AddMovieView ÂíåÂØπÂ∫îÁöÑ ViewModel"></a>AddMovieView ÂíåÂØπÂ∫îÁöÑ ViewModel</h2><p><code>AddMovieView</code> ÁöÑ view model ÊòØÈöèÁùÄ MovieStore ‰∏ÄÂêåË¢´ÂàùÂßãÂåñÁöÑÔºåÂÆÉÂÜÖÈÉ®ÂëàÁé∞‰∫Ü‰∏Ä‰∏™ Movie ÂÆû‰æã„ÄÇ Published Â±ûÊÄßÂåÖË£ÖÂô®Âíå MovieListView ÁöÑ view model ÈáåÁöÑÁî®Ê≥ïÁõ∏‰ºº„ÄÇ ÂÜÖÈÉ®ÁöÑ movie ÂØπË±°ÊòØ‰∏Ä‰∏™ÁßÅÊúâÁöÑÂ±ûÊÄßÔºå TextField Âíå Picker ÈÉΩÈááÁî®ÂèåÂêë Binding „ÄÇ Binding ÊòØ‰∏ÄÁßç view Âíå model Èó¥ÁöÑÂèåÂêëËøûÊé•ÊñπÂºè„ÄÇÂè¶Â§ñÔºåËøòÊúâ‰∏Ä‰∏™ <code>canSave</code> Â±ûÊÄßÔºåÂÆÉÊòØÁî®Êù•ÊéßÂà∂ÂØºËà™Ê†è‰∏äÁöÑ‰øùÂ≠òÊåâÈíÆÊòØÂê¶ÂêØÁî®„ÄÇ‰øùÊåÅÊåâÈíÆÂè™ÊúâÂú®Ê†áÈ¢òÊúâÂ°´ÂÖÖÁöÑÊó∂ÊâçÂêØÁî®„ÄÇ</p>
<p>ÁÆÄÂçïÂ§ç‰π†‰∏Ä‰∏ãËßÜÂõæÊõ¥Êñ∞ÁöÑÊµÅÁ®ãÔºöTextField ÊàñËÄÖ Picker ‰ºöÂà©Áî® Binding Êù•Êõ¥Êñ∞ÁßÅÊúâÂ±ûÊÄß <code>newMovie</code> „ÄÇ Âõ†‰∏∫ newMovie Â±ûÊÄß‰ΩøÁî®‰∫Ü @Published Â±ûÊÄßÂåÖË£ÖÂô®ÔºåÂÆÉ‰ºöÂèëÂ∞Ñ ObservableObject ÁöÑ objectWillChange publisher „ÄÇ SwiftUI Ëá™Âä®ËÆ¢ÈòÖ objectWillChange ÔºåÂõ†‰∏∫ view model ÁöÑÂ±ûÊÄßÁî®‰∫Ü @ObservedObject „ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">AddMovieView</span> </span>{</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ViewModel</span>: <span class="title">ObservableObject</span> </span>{</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">let</span> movieStore: <span class="type">MovieStore</span></span><br><span class="line">         </span><br><span class="line">        <span class="keyword">init</span>(movieStore: <span class="type">MovieStore</span>) {</span><br><span class="line">            <span class="keyword">self</span>.movieStore = movieStore</span><br><span class="line">        }</span><br><span class="line">         </span><br><span class="line">        @<span class="type">Published</span> <span class="keyword">private</span> <span class="keyword">var</span> newMovie = <span class="type">Movie</span>(fullTitle: <span class="string">""</span>)</span><br><span class="line">         </span><br><span class="line">        <span class="built_in">lazy</span> <span class="keyword">var</span> title = <span class="type">Binding</span>&lt;<span class="type">String</span>&gt;(<span class="keyword">get</span>: {</span><br><span class="line">            <span class="keyword">self</span>.newMovie.fullTitle</span><br><span class="line">        }, <span class="keyword">set</span>: {</span><br><span class="line">            <span class="keyword">self</span>.newMovie.fullTitle = $<span class="number">0</span></span><br><span class="line">        })</span><br><span class="line">         </span><br><span class="line">        <span class="built_in">lazy</span> <span class="keyword">var</span> rating = <span class="type">Binding</span>&lt;<span class="type">Movie</span>.<span class="type">Rating</span>&gt;(<span class="keyword">get</span>: {</span><br><span class="line">            <span class="keyword">self</span>.newMovie.givenRating</span><br><span class="line">        }, <span class="keyword">set</span>: {</span><br><span class="line">            <span class="keyword">self</span>.newMovie.givenRating = $<span class="number">0</span></span><br><span class="line">        })</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">var</span> canSave: <span class="type">Bool</span> {</span><br><span class="line">            <span class="keyword">return</span> !newMovie.fullTitle.isEmpty</span><br><span class="line">        }</span><br><span class="line">         </span><br><span class="line">        <span class="function"><span class="keyword">func</span> <span class="title">save</span><span class="params">()</span></span> {</span><br><span class="line">            movieStore.add (newMovie)</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">AddMovieView</span>: <span class="title">View</span> </span>{</span><br><span class="line">    @<span class="type">Environment</span>(\.presentationMode) <span class="keyword">private</span> <span class="keyword">var</span> presentationMode</span><br><span class="line">    @<span class="type">ObservedObject</span> <span class="keyword">var</span> viewModel: <span class="type">ViewModel</span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> {</span><br><span class="line">        <span class="type">NavigationView</span> {</span><br><span class="line">            <span class="type">Form</span> {</span><br><span class="line">                titleSection</span><br><span class="line">                ratingSection</span><br><span class="line">            }.navigationBarTitle (<span class="string">"Add Movie"</span>, displayMode: .inline)</span><br><span class="line">                .navigationBarItems (leading: leadingBarItem, trailing: trailingBarItem)</span><br><span class="line">                .navigationViewStyle (<span class="type">StackNavigationViewStyle</span>())</span><br><span class="line">             </span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> titleSection: some <span class="type">View</span> {</span><br><span class="line">        <span class="type">Section</span>() {</span><br><span class="line">            <span class="type">TextField</span>(<span class="string">"Title"</span>, text: viewModel.title)</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> ratingSection: some <span class="type">View</span> {</span><br><span class="line">        <span class="type">Section</span>() {</span><br><span class="line">            <span class="type">Picker</span>(<span class="type">LocalizedStringKey</span>(<span class="string">"Rating"</span>), selection: viewModel.rating) {</span><br><span class="line">                <span class="type">ForEach</span>(<span class="type">Movie</span>.<span class="type">Rating</span>.allCases, id: \.rawValue) {</span><br><span class="line">                    <span class="type">Text</span>($<span class="number">0</span>.localizedName).tag ($<span class="number">0</span>)</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> leadingBarItem: some <span class="type">View</span> {</span><br><span class="line">        <span class="type">Button</span>(action: { <span class="keyword">self</span>.presentationMode.wrappedValue.dismiss () }, label: {</span><br><span class="line">            <span class="type">Text</span>(<span class="string">"Cancel"</span>)</span><br><span class="line">        })</span><br><span class="line">    }</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> trailingBarItem: some <span class="type">View</span> {</span><br><span class="line">        <span class="type">Button</span>(action: {</span><br><span class="line">            <span class="keyword">self</span>.viewModel.save ()</span><br><span class="line">            <span class="keyword">self</span>.presentationMode.wrappedValue.dismiss ()</span><br><span class="line">        }, label: {</span><br><span class="line">            <span class="type">Text</span>(<span class="string">"Save"</span>).disabled (!<span class="keyword">self</span>.viewModel.canSave)</span><br><span class="line">        })</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="ÊÄªÁªì"><a href="#ÊÄªÁªì" class="headerlink" title="ÊÄªÁªì"></a>ÊÄªÁªì</h2><p>Êàë‰ª¨ÂàõÂª∫‰∫Ü‰∏Ä‰∏™Âè™Êúâ‰∏§‰∏™ËßÜÂõæÁöÑÁÆÄÂçï app „ÄÇ‰∏§‰∏™ËßÜÂõæÈÉΩÊúâÂêÑËá™ÁöÑ view model ÔºåÂπ∂‰∏îÈÉΩ‰æùËµñ MovieStore „ÄÇ‰∏Ä‰∏™ view model ‰∏≠Ëß¶Âèë‰∫Ü MovieStore ÁöÑÊîπÂèòÔºåËøô‰∫õÊîπÂèò‰ºöË¢´Âè¶‰∏Ä‰∏™ view model ËßÇÂØüÂà∞„ÄÇÂè¶Â§ñÔºåÊàë‰ª¨Ëøò‰∫ÜËß£‰∫Ü SwiftUI ÁöÑ environment ‰ª•ÂèäÂ¶Ç‰Ωï‰ªé view model ‰∏≠Ëß¶Âèë view Êõ¥Êñ∞„ÄÇ</p>
<hr>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://theinfinitegame.tech/uncategorized/note-swiftui-dynamic-user-notification-on-apple-watch/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Áå´ÂÖãÊùØ">
      <meta itemprop="description" content="Stay hungry, stay foolish.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="The Infinite Game">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/uncategorized/note-swiftui-dynamic-user-notification-on-apple-watch/" class="post-title-link" itemprop="url">note-swiftui-dynamic-user-notification-on-apple-watch</a>
        </h1>

        <div class="post-meta">

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">ÂèëË°®‰∫é</span>

              <time title="ÂàõÂª∫Êó∂Èó¥Ôºö2020-03-01 17:08:42" itemprop="dateCreated datePublished" datetime="2020-03-01T17:08:42+08:00">2020-03-01</time>
            </span>

          <br>
            <span class="post-meta-item" title="Êú¨ÊñáÂ≠óÊï∞">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">Êú¨ÊñáÂ≠óÊï∞Ôºö</span>
              <span>14k</span>
            </span>
            <span class="post-meta-item" title="ÈòÖËØªÊó∂Èïø">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">ÈòÖËØªÊó∂Èïø &asymp;</span>
              <span>13 ÂàÜÈíü</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <hr>
<p>title: SwiftUI Â∫îÁî® | ÊµáÊ∞¥ÊèêÈÜí app<br>top: false<br>date: 2020-03-01 17:08:42<br>tags:</p>
<ul>
<li>watchOS</li>
<li>development</li>
<li>swiftui<br>categories: development<br>description:</li>
</ul>
<hr>
<h1 id="Áî®-SwiftUI-Âú®-Apple-Watch-‰∏äÊûÑÂª∫Âä®ÊÄÅÈÄöÁü•"><a href="#Áî®-SwiftUI-Âú®-Apple-Watch-‰∏äÊûÑÂª∫Âä®ÊÄÅÈÄöÁü•" class="headerlink" title="Áî® SwiftUI Âú® Apple Watch ‰∏äÊûÑÂª∫Âä®ÊÄÅÈÄöÁü•"></a>Áî® SwiftUI Âú® Apple Watch ‰∏äÊûÑÂª∫Âä®ÊÄÅÈÄöÁü•</h1><blockquote>
<p>ËØëËá™ <a href="https://augmentedcode.io/2020/02/02/dynamic-user-notification-on-apple-watch-with-swiftui/" target="_blank" rel="noopener">Dynamic user notification on Apple Watch with SwiftUI</a><br>Ê∫êÁ†ÅÂú∞ÂùÄÔºö<a href="https://github.com/laevandus/WaterMyPlants" target="_blank" rel="noopener">WaterMyPlants</a></p>
</blockquote>
<p>ÈõÜÊàê‰∫ÜÊé®ÈÄÅÊàñËÄÖÊú¨Âú∞ÈÄöÁü•ÁöÑ app ÂèØ‰ª•ÂÆöÂà∂ apple watch ‰∏äÁöÑÈÄöÁü•„ÄÇÊú¨ÊñáÊòØÂÖ≥‰∫éÂ¶Ç‰ΩïÂú® apple watch ‰∏äÂÆûÁé∞Âä®ÊÄÅÈÄöÁü•ÁöÑÁ¨îËÆ∞„ÄÇÊ†∑‰æãÂ∑•Á®ãÂÆûÁé∞‰∏Ä‰∏™ÊèêÈÜíÁªôÊ§çÁâ©ÊµáÊ∞¥ÁöÑÂäüËÉΩ„ÄÇÊàë‰ª¨‰ºöËÅöÁÑ¶Âú®Ê∑ªÂä†ÈÄöÁü•ËßÜÂõæÔºåÁúÅÁï•‰ªé iOS app ÂèëÈÄÅÈÄöÁü•ÁöÑÊ≠•È™§„ÄÇ</p>
<h2 id="‰∏∫-Apple-Watch-Ê∑ªÂä†ÂØåÊñáÊú¨ÈÄöÁü•Ê∑ªÂä†ÊûÑÂª∫ÁõÆÊ†á"><a href="#‰∏∫-Apple-Watch-Ê∑ªÂä†ÂØåÊñáÊú¨ÈÄöÁü•Ê∑ªÂä†ÊûÑÂª∫ÁõÆÊ†á" class="headerlink" title="‰∏∫ Apple Watch Ê∑ªÂä†ÂØåÊñáÊú¨ÈÄöÁü•Ê∑ªÂä†ÊûÑÂª∫ÁõÆÊ†á"></a>‰∏∫ Apple Watch Ê∑ªÂä†ÂØåÊñáÊú¨ÈÄöÁü•Ê∑ªÂä†ÊûÑÂª∫ÁõÆÊ†á</h2><p>Â¶ÇÊûúÂ∑•Á®ãÈáåÊ≤°Êúâ App Watch app Ôºå‰Ω†ÈúÄË¶ÅÊ∑ªÂä†ÂÆÉ„ÄÇÂú® Xcode ‰∏≠ÔºåÊàë‰ª¨Êñ∞Â¢û‰∏Ä‰∏™ÊûÑÂª∫ÁõÆÊ†áÔºåÂπ∂ÈÖçÁΩÆÊàêÂåÖÂê´ÈÄöÁü•Âú∫ÊôØ„ÄÇÊâìÂºÄ New -&gt; Target:</p>
<p><img src="/images/watch_app_target.png" width="80%" height="80%" style="margin: 10 auto;"></p>
<p>Á°Æ‰øù User Interface ÈÄâÊã©ÔºåÂπ∂‰∏î ‚ÄúInclude Notification Scene‚Äù ÈÄâ‰∏≠„ÄÇÊàë‰ª¨Â∞Ü‰ºöÊääÂÆÉÂµåÂÖ•ÂΩìÂâçÁöÑ iOS app ÔºåÊâÄ‰ª• ‚ÄúEmbed in Companion App‚Äù Ë¶ÅÈÄâÊã©ÂΩìÂâç app „ÄÇÂÄºÂæó‰∏ÄÊèêÁöÑÊòØÔºå‰ªé iOS 13 Âíå WatchOS 6 ÂºÄÂßãÔºåApple Watch app Â∑≤ÁªèÂèØ‰ª•Áã¨Á´ãÂ≠òÂú®‰∫Ü„ÄÇ</p>
<p><img src="/images/watch_app_target_2.png" width="80%" height="80%" style="margin: 10 auto;"></p>
<p>ÁÇπÂáªÂÆåÊàêÔºåXcode ‰ºöËØ¢ÈóÆÊøÄÊ¥ªÊñ∞ÁöÑ scheme ÔºåÁÇπÂáªÊøÄÊ¥ªÔºåÂÆÉ‰ºöËá™Âä®ÈÄâÊã©Êñ∞Âª∫ÁöÑÁõÆÊ†áÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•Áõ¥Êé•ÂºÄÂßãÂÜô‰ª£Á†Å‰∫Ü„ÄÇÂÖàÊ£ÄÊü•Â∑•Á®ãÔºå‰ºöÂèëÁé∞ Xcode Âä†‰∫Ü‰∏§‰∏™ÁõÆÊ†áÔºöwatch app Âíå extension„ÄÇApp ÂåÖÂê´‰∫Ü storyboard ÔºåËÄå extension ÂåÖÂê´‰∫ÜÊâÄÊúâÁöÑ‰ª£Á†Å„ÄÇ storyboard ÊòØÊèê‰æõÂü∫‰∫é <code>WKHostingController</code> ÁöÑÂ≠êÁ±ªÁöÑ HostingController ÊºîÁ§∫Áî®ÁöÑÂú∫ÊôØ„ÄÇËøô‰∏™Á±ªË¥üË¥£ÊâøËΩΩ‰Ω†ÁöÑ Apple Watch app ÁöÑ SwiftUI ËßÜÂõæ„ÄÇÂè¶Â§ñÔºåËøòÊúâ‰∏§‰∏™Âú∫ÊôØÔºåÂàÜÂà´ÊòØÈùôÊÄÅÂíåÂä®ÊÄÅÈÄöÁü•„ÄÇÊàë‰ª¨ÂØπÂä®ÊÄÅÈÄöÁü•ÊÑüÂÖ¥Ë∂£ÔºåÂú® storyboard ÈáåÂèØ‰ª•ÁúãËßÅÂä®ÊÄÅËßÜÂõæÊòØÁî± <code>NotificationController</code> Êèê‰æõÁöÑÔºåÂÆÉÊòØ <code>WKUserNotificationHostingController</code> ÁöÑÂ≠êÁ±ªÔºåÊâøËΩΩÈÄöÁü•ÁöÑ SwiftUI ËßÜÂõæ„ÄÇËøôÈáåÂ∞±ÊòØÊàë‰ª¨ÁªôÈÄöÁü•Êèê‰æõËá™ÂÆö‰πâÁïåÈù¢ÁöÑÂú∞Êñπ„ÄÇÂ¶ÇÊûúÈÄöÁü•ÁöÑÂàÜÁ±ªÂíå storyboard ÈáåÈ¢ÑÂÖàÂÆö‰πâÁöÑÂåπÈÖçÔºåÂ∞±‰ºöÈÄâÊã©Âä®ÊÄÅÈÄöÁü•ËßÜÂõæ„ÄÇ</p>
<h2 id="Ëß£ÊûêÈÄöÁü•ÁöÑ-payload-Âπ∂ËÆæÁΩÆÂä®ÊÄÅÈÄöÁü•ËßÜÂõæ"><a href="#Ëß£ÊûêÈÄöÁü•ÁöÑ-payload-Âπ∂ËÆæÁΩÆÂä®ÊÄÅÈÄöÁü•ËßÜÂõæ" class="headerlink" title="Ëß£ÊûêÈÄöÁü•ÁöÑ payload Âπ∂ËÆæÁΩÆÂä®ÊÄÅÈÄöÁü•ËßÜÂõæ"></a>Ëß£ÊûêÈÄöÁü•ÁöÑ payload Âπ∂ËÆæÁΩÆÂä®ÊÄÅÈÄöÁü•ËßÜÂõæ</h2><p>NotificationController ÁöÑËÅåË¥£ÊòØÊ∂àË¥πÁî®Êà∑ÈÄöÁü•ÁöÑ payload ÔºåÂπ∂ÁîüÊàê SwiftUI ËßÜÂõæÊù•Â±ïÁ§∫ÂÆÉ‰ª¨„ÄÇÁî®Êà∑ÈÄöÁü•ÊòØ‰ªé <code>didReceive</code> ÂáΩÊï∞Êé•Êî∂ÁöÑÔºåÊàë‰ª¨ÈúÄË¶ÅÈáäÊîæ‰ø°ÊÅØÔºåÁî®‰∫éËßÜÂõæ„ÄÇÂú®Êú¨Âú∞ÊµãËØïÁöÑÊó∂ÂÄôÔºåÊàë‰ª¨ÂèØ‰ª•ÊääÊµãËØïÊï∞ÊçÆÂÜôÂú® <code>PushNotificationPayload.apns</code> Êñá‰ª∂Èáå„ÄÇÂõ†‰∏∫Êàë‰ª¨Ë¶ÅÂ±ïÁ§∫ÁöÑÊòØÂÖ≥‰∫éÊ§çÁâ©ÁöÑ‰ø°ÊÅØÔºåÊâÄÊúâÊàë‰ª¨Ê∑ªÂä†‰∏Ä‰∏™Ê§çÁâ©ÂØπË±°Âà∞Êñá‰ª∂‰∏≠„ÄÇÂêåÊó∂ÔºåÊàë‰ª¨ËøòÈúÄË¶ÅÊääÈÄöÁü•ÂàÜÁ±ª‰øÆÊîπÊàêÊüê‰∏™ÊúâÂê´‰πâÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇÁ°Æ‰øù‰Ω†ËÆæÁΩÆÊñ∞ÁöÑÂàÜÁ±ªÊó∂Ê≠£Á°ÆÊõ¥Êñ∞ storyboard „ÄÇ</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="attr">"aps"</span>: {</span><br><span class="line">        <span class="attr">"alert"</span>: {</span><br><span class="line">            <span class="attr">"body"</span>: <span class="string">"Test message"</span>,</span><br><span class="line">            <span class="attr">"title"</span>: <span class="string">"Optional title"</span>,</span><br><span class="line">            <span class="attr">"subtitle"</span>: <span class="string">"Optional subtitle"</span></span><br><span class="line">        },</span><br><span class="line">        <span class="attr">"category"</span>: <span class="string">"WATERING_REMINDER"</span>,</span><br><span class="line">        <span class="attr">"thread-id"</span>: <span class="string">"plantid123"</span></span><br><span class="line">    },</span><br><span class="line">     </span><br><span class="line">    <span class="attr">"plant"</span>: {</span><br><span class="line">        <span class="attr">"id"</span>: <span class="string">"plantid123"</span>,</span><br><span class="line">        <span class="attr">"name"</span>: <span class="string">"Aloe"</span>,</span><br><span class="line">        <span class="attr">"lastDate"</span>: <span class="number">1579937802</span>,</span><br><span class="line">        <span class="attr">"nextDate"</span>: <span class="number">1580515200</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/watch_app_target_3.png" width="50%" height="50%" style="margin: 10 auto;"></p>
<p>ÂΩìÊàë‰ª¨ËÆøÈóÆ <code>UNNotification.request.content.userInfo</code> ÊãøÂà∞Ê§çÁâ©ÁöÑ‰ø°ÊÅØÊó∂ÔºåÊàë‰ª¨ÂèØ‰ª•Áî® <code>Decodable</code> Âíå <code>JSONDecoder</code> Â∞Ü‰ª£Ë°®Ê§çÁâ©ÁöÑÂ≠óÂÖ∏ËΩ¨Êç¢ÊàêÂÄºÁ±ªÂûã„ÄÇ <code>JSONDecoder</code> Êé•Êî∂ <code>JSON</code> Êï∞ÊçÆÔºåÊâÄ‰ª•Êàë‰ª¨ÂÖàÁî® <code>JSONSerialization</code> ÂåÖË£ÖÊï∞ÊçÆÔºåÁÑ∂ÂêéÊääÂåÖË£ÖÁöÑÁªìÊûú‰º†Áªô <code>JSONDecoder</code> „ÄÇ ÊàñËÄÖÊàë‰ª¨‰πüÂèØ‰ª•ÊâãÂä®‰ªé <code>userInfo</code> Â≠óÂÖ∏ÈáåËØªÂèñÊâÄÊúâÁöÑÂÄºÔºåÁÑ∂ÂêéÂàõÂª∫Âá∫Ê§çÁâ©Á±ªÂûã„ÄÇÁïôÊÑèÔºåÊàë‰ª¨ÈúÄË¶ÅÁî® view model Êù•Êèê‰æõÊï∞ÊçÆÁªô SwiftUI ÔºåËÄå‰∏çÊòØÁõ¥Êé•‰ΩøÁî® <code>Plant</code> Á±ªÂûã„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Plant</span>: <span class="title">Decodable</span> </span>{</span><br><span class="line">    <span class="keyword">let</span> id: <span class="type">String</span></span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">let</span> lastDate: <span class="type">Date</span></span><br><span class="line">    <span class="keyword">let</span> nextDate: <span class="type">Date</span></span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">do</span> {</span><br><span class="line">        <span class="keyword">let</span> plantInfo = notification.request.content.userInfo [<span class="string">"plant"</span>] <span class="keyword">as</span>! [<span class="type">String</span>: <span class="type">Any</span>]</span><br><span class="line">        <span class="keyword">let</span> data = <span class="keyword">try</span> <span class="type">JSONSerialization</span>.data (withJSONObject: plantInfo, options: [])</span><br><span class="line">        <span class="keyword">let</span> decoder = <span class="type">JSONDecoder</span>()</span><br><span class="line">        decoder.dateDecodingStrategy = .secondsSince1970</span><br><span class="line">        <span class="keyword">let</span> plant = <span class="keyword">try</span> decoder.decode (<span class="type">Plant</span>.<span class="keyword">self</span>, from: data)</span><br><span class="line">        viewModel = <span class="type">NotificationViewModel</span>(plant: plant)</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">catch</span> <span class="keyword">let</span> nsError <span class="keyword">as</span> <span class="type">NSError</span> {</span><br><span class="line">        <span class="built_in">print</span>(nsError.localizedDescription)</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure>
<p>Âè¶Â§ñÔºåÊàë‰ª¨ÊÉ≥Ë¶ÅÊ∑ªÂä†‰∏â‰∏™Áî®Êà∑ÂèØ‰ª•ÊâßË°åÁöÑÂä®‰ΩúÔºöÊ†áËÆ∞Ê§çÁâ©Â∑≤ÁªèÊµáÊ∞¥ÔºåÊé®ÂêéÊèêÈÜíÔºåÊàñËÄÖÂÆâÊéíÊòéÂ§©ÂÜçÊèêÈÜí„ÄÇËøô‰∫õÂä®‰ΩúÊòØÁî® <code>UNNotificationAction</code> ÂÆû‰æãË°®Á§∫„ÄÇÂΩìÁî®Êà∑ÁÇπÂáª‰ªªÊÑèÂÖ∂‰∏≠‰∏Ä‰∏™Êó∂Ôºå<code>UNUserNotificationCenter</code> ÁöÑÂßîÊâòÊñπÊ≥ï‰ºöË¢´Ë∞ÉÁî®ÔºåÂπ∂‰∏îÂ∏¶ÊúâËØ•Âä®‰ΩúÁöÑ <code>identifier</code> „ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> doneTitle = <span class="type">NSLocalizedString</span>(<span class="string">"NotificationAction_Done"</span>, comment: <span class="string">"Done button title in notification."</span>)</span><br><span class="line"><span class="keyword">let</span> laterTitle = <span class="type">NSLocalizedString</span>(<span class="string">"NotificationAction_Later"</span>, comment: <span class="string">"Later button title in notification."</span>)</span><br><span class="line"><span class="keyword">let</span> tomorrowTitle = <span class="type">NSLocalizedString</span>(<span class="string">"NotificationAction_Tomorrow"</span>, comment: <span class="string">"Tomorrow button title in notification."</span>)</span><br><span class="line">notificationActions = [</span><br><span class="line">    <span class="type">UNNotificationAction</span>(identifier: <span class="string">"water_done"</span>, title: doneTitle, options: []),</span><br><span class="line">    <span class="type">UNNotificationAction</span>(identifier: <span class="string">"water_later"</span>, title: laterTitle, options: []),</span><br><span class="line">    <span class="type">UNNotificationAction</span>(identifier: <span class="string">"water_tomorrow"</span>, title: tomorrowTitle, options: [])</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>
<p><code>NotificationController</code> ÁöÑÂÆåÊï¥ÂÆûÁé∞Â¶Ç‰∏ãÔºö</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">NotificationController</span>: <span class="title">WKUserNotificationHostingController</span>&lt;<span class="title">NotificationView</span>&gt; </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> viewModel: <span class="type">NotificationViewModel?</span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">var</span> body: <span class="type">NotificationView</span> {</span><br><span class="line">        <span class="keyword">return</span> <span class="type">NotificationView</span>(viewModel: viewModel!)</span><br><span class="line">    }</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">didReceive</span><span class="params">(<span class="number">_</span> notification: UNNotification)</span></span> {</span><br><span class="line">        <span class="keyword">do</span> {</span><br><span class="line">            <span class="keyword">let</span> plantInfo = notification.request.content.userInfo [<span class="string">"plant"</span>] <span class="keyword">as</span>! [<span class="type">String</span>: <span class="type">Any</span>]</span><br><span class="line">            <span class="keyword">let</span> data = <span class="keyword">try</span> <span class="type">JSONSerialization</span>.data (withJSONObject: plantInfo, options: [])</span><br><span class="line">            <span class="keyword">let</span> decoder = <span class="type">JSONDecoder</span>()</span><br><span class="line">            decoder.dateDecodingStrategy = .secondsSince1970</span><br><span class="line">            <span class="keyword">let</span> plant = <span class="keyword">try</span> decoder.decode (<span class="type">Plant</span>.<span class="keyword">self</span>, from: data)</span><br><span class="line">            viewModel = <span class="type">NotificationViewModel</span>(plant: plant)</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">catch</span> <span class="keyword">let</span> nsError <span class="keyword">as</span> <span class="type">NSError</span> {</span><br><span class="line">            <span class="built_in">print</span>(nsError.localizedDescription)</span><br><span class="line">        }</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">let</span> doneTitle = <span class="type">NSLocalizedString</span>(<span class="string">"NotificationAction_Done"</span>, comment: <span class="string">"Done button title in notification."</span>)</span><br><span class="line">        <span class="keyword">let</span> laterTitle = <span class="type">NSLocalizedString</span>(<span class="string">"NotificationAction_Later"</span>, comment: <span class="string">"Later button title in notification."</span>)</span><br><span class="line">        <span class="keyword">let</span> tomorrowTitle = <span class="type">NSLocalizedString</span>(<span class="string">"NotificationAction_Tomorrow"</span>, comment: <span class="string">"Tomorrow button title in notification."</span>)</span><br><span class="line">        notificationActions = [</span><br><span class="line">            <span class="type">UNNotificationAction</span>(identifier: <span class="string">"water_done"</span>, title: doneTitle, options: []),</span><br><span class="line">            <span class="type">UNNotificationAction</span>(identifier: <span class="string">"water_later"</span>, title: laterTitle, options: []),</span><br><span class="line">            <span class="type">UNNotificationAction</span>(identifier: <span class="string">"water_tomorrow"</span>, title: tomorrowTitle, options: [])</span><br><span class="line">        ]</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="ÂëàÁé∞ÈÄöÁü•ÁöÑ-NotificationView"><a href="#ÂëàÁé∞ÈÄöÁü•ÁöÑ-NotificationView" class="headerlink" title="ÂëàÁé∞ÈÄöÁü•ÁöÑ NotificationView"></a>ÂëàÁé∞ÈÄöÁü•ÁöÑ NotificationView</h2><p>‰∏äÈù¢ÊèêÂà∞ view model <code>NotificationViewModel</code> ‰∏∫ NotificationView Êèê‰æõÊñáÊú¨ÔºåÂÆÉ‰∏ªË¶ÅÂ§ÑÁêÜÊó•ÊúüÁöÑÊ†ºÂºèÂåñÂ≠óÁ¨¶„ÄÇ </p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NotificationViewModel</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> plant: <span class="type">Plant</span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">init</span>(plant: <span class="type">Plant</span>) {</span><br><span class="line">        <span class="keyword">self</span>.plant = plant</span><br><span class="line">    }</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">var</span> title: <span class="type">String</span> {</span><br><span class="line">        <span class="keyword">return</span> plant.name</span><br><span class="line">    }</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">var</span> subtitle: <span class="type">String</span> {</span><br><span class="line">        <span class="keyword">return</span> <span class="type">NSLocalizedString</span>(<span class="string">"NotificationView_Subtitle"</span>, comment: <span class="string">"Notification suggestion text"</span>)</span><br><span class="line">    }</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> dateFormatter: <span class="type">DateFormatter</span> = {</span><br><span class="line">        <span class="keyword">let</span> formatter = <span class="type">DateFormatter</span>()</span><br><span class="line">        formatter.dateFormat = <span class="type">DateFormatter</span>.dateFormat (fromTemplate: <span class="string">"dMMMM"</span>, options: <span class="number">0</span>, locale: .current)</span><br><span class="line">        <span class="keyword">return</span> formatter</span><br><span class="line">    }()</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">var</span> lastWatering: <span class="type">String</span> {</span><br><span class="line">        <span class="keyword">let</span> format = <span class="type">NSLocalizedString</span>(<span class="string">"NotificationView_LastWatering"</span>, comment: <span class="string">"Last watering date."</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="type">String</span>(format: format, dateFormatter.string (from: plant.lastDate))</span><br><span class="line">    }</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">var</span> nextWatering: <span class="type">String</span> {</span><br><span class="line">        <span class="keyword">let</span> format = <span class="type">NSLocalizedString</span>(<span class="string">"NotificationView_NextWatering"</span>, comment: <span class="string">"Next watering date."</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="type">String</span>(format: format, dateFormatter.string (from: plant.nextDate))</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>SwiftUI ËßÜÂõæÂæàÁÆÄÂçïÔºå4 ‰∏™ÊñáÊú¨„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NotificationView</span>: <span class="title">View</span> </span>{</span><br><span class="line">    <span class="keyword">let</span> viewModel: <span class="type">NotificationViewModel</span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> {</span><br><span class="line">        <span class="type">VStack</span> {</span><br><span class="line">            <span class="type">Text</span>(viewModel.title).font (.title)</span><br><span class="line">            <span class="type">Text</span>(viewModel.subtitle).font (.subheadline)</span><br><span class="line">            <span class="type">Divider</span>()</span><br><span class="line">            <span class="type">Text</span>(viewModel.lastWatering).font (.body).multilineTextAlignment (.center)</span><br><span class="line">            <span class="type">Text</span>(viewModel.nextWatering).font (.body).multilineTextAlignment (.center)</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/images/watch_notification_1.png" width="30%" height="30%" style="margin: 10 auto;"></p>
<p><img src="/images/watch_notification_2.png" width="30%" height="30%" style="margin: 10 auto;"></p>
<h2 id="Â∞èÁªì"><a href="#Â∞èÁªì" class="headerlink" title="Â∞èÁªì"></a>Â∞èÁªì</h2><p>Êàë‰ª¨ÂæÄ‰∏Ä‰∏™ iOS app ‰∏≠Ê∑ªÂä†‰∫Ü watch app ÔºåÂÆûÁé∞‰∏Ä‰∏™ÈÄöÁü•ÂàÜÁ±ªÁöÑÂä®ÊÄÅÈÄöÁü•ËßÜÂõæ„ÄÇÊàë‰ª¨Â≠¶‰π†‰∫ÜÂ¶Ç‰ΩïËß£ÊûêÈÄöÁü•Êï∞ÊçÆÔºåÊ∑ªÂä†Âä®‰ΩúÊåâÈíÆ„ÄÇ‰∏ã‰∏ÄÊ≠•ÊòØÂú® companion iOS app ÈáåÂü∫‰∫éÊåâÈíÆÁöÑ identifier Â§ÑÁêÜÂØπÂ∫îÈÄöÁü•Âä®‰Ωú„ÄÇ</p>
<hr>
<h1 id="ÊãâÂèñÂíåÊòæÁ§∫Êï∞ÊçÆ"><a href="#ÊãâÂèñÂíåÊòæÁ§∫Êï∞ÊçÆ" class="headerlink" title="ÊãâÂèñÂíåÊòæÁ§∫Êï∞ÊçÆ"></a>ÊãâÂèñÂíåÊòæÁ§∫Êï∞ÊçÆ</h1><p> Ëøô‰∏ÄËäÇÁöÑ‰∏ªÈ¢òÊòØ‰ªé compasion iOS app ÁöÑ CoreData Â≠òÂÇ®‰∏≠Ëé∑ÂèñÊï∞ÊçÆÔºåÈúÄË¶ÅÂÄüÂä© WatchConnectivity framework „ÄÇ</p>
<h2 id="iOS-Âíå-WatchOS-app-‰πãÈó¥ÁöÑ-session"><a href="#iOS-Âíå-WatchOS-app-‰πãÈó¥ÁöÑ-session" class="headerlink" title="iOS Âíå WatchOS app ‰πãÈó¥ÁöÑ session"></a>iOS Âíå WatchOS app ‰πãÈó¥ÁöÑ session</h2><p> iOS app Áî® CoreData Êù•Â≠òÂÇ®Ê§çÁâ©ÂàóË°®ÔºåËÆ∞ÂΩï‰∫ÜÊØèÊ†™Ê§çÁâ©‰∏ä‰∏ÄÊ¨°Âíå‰∏ã‰∏ÄÊ¨°ÊµáÊ∞¥ÁöÑÊó•Êúü„ÄÇÂú®ËøôÈáåÔºåÊ≤°Êúâ web ÊúçÂä°ÔºåÊâÄÊúâÁöÑ‰∏úË•øÈÉΩÂ≠òÂú®ËÆæÂ§á‰∏ä„ÄÇÈÇ£‰πàÂ¶Ç‰ΩïÊääÊåÅ‰πÖÂåñÂ≠òÂÇ®‰∏≠ÁöÑÊï∞ÊçÆÊãøÁªô WatchOS app ‰ΩøÁî®Âë¢Ôºü</p>
<p>Êàë‰ª¨‰ºöÁî®Âà∞ WatchConnectivity framework Êù•ÂÅö iOS Âíå WatchOS app ‰πãÈó¥ÁöÑ‰∫§‰∫í„ÄÇËøûÊé•ÊòØÂú® iOS Âíå WatchOS app ‰∏äÈÉΩÊøÄÊ¥ª <code>WCSession</code> Êù•ÂÆûÁé∞ÁöÑ„ÄÇÂõ†Ê≠§ÔºåÁ¨¨‰∏ÄÊ≠•ÊòØÊ∑ªÂä†‰∏Ä‰∏™ÁÆ°ÁêÜ <code>WCSession</code> ÁöÑÁ±ªÂà∞ iOS Â∑•Á®ãÔºåÊàë‰ª¨‰∏çÂ¶®Áß∞ÂÆÉ‰∏∫ WatchConnectivityProvider (Á®çÂêé‰πü‰ºöÊ∑ªÂä†‰∏Ä‰∏™Áõ∏‰ººÁöÑÁ±ªÂà∞ WatchOS app)„ÄÇÂÆÉÁöÑ‰∏ªË¶ÅËÅåËÉΩÊòØÂª∫Á´ã <code>WCSession</code> ÔºåÂ§ÑÁêÜ <code>WCSessionDelegate</code> ÔºåÂÖ∂‰∏≠ÂåÖÂê´‰ªé CoreData Â≠òÂÇ®ÊãâÂèñÊï∞ÊçÆ„ÄÇÂõ†Ê≠§ÔºåÊúâ‰∏Ä‰∏™Âè´ <code>NSPersistentContainer</code> ÁöÑÂèÇÊï∞‰ºöÊèê‰æõÂØπ <code>CoreData</code> Ê†àÁöÑËÆøÈóÆ (ÂÄüÁî±ËÆøÈóÆ performBackgroundTask ÂáΩÊï∞)„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">WatchConnectivityProvider</span>: <span class="title">NSObject</span>, <span class="title">WCSessionDelegate</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> persistentContainer: <span class="type">NSPersistentContainer</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> session: <span class="type">WCSession</span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">init</span>(session: <span class="type">WCSession</span> = .<span class="keyword">default</span>, persistentContainer: <span class="type">NSPersistentContainer</span>) {</span><br><span class="line">        <span class="keyword">self</span>.persistentContainer = persistentContainer</span><br><span class="line">        <span class="keyword">self</span>.session = session</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</span><br><span class="line">        session.delegate = <span class="keyword">self</span></span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure>
<p><code>WCSession</code> ÊòØÈÄöËøáË∞ÉÁî® activate () Êù•ÊøÄÊ¥ªÔºåÊøÄÊ¥ªËøáÁ®ãÊòØÂºÇÊ≠•ÁöÑ„ÄÇÊøÄÊ¥ªÁöÑÂìçÂ∫îÈÄöËøá <code>session (_:activationDidCompleteWith:error:)</code> ÂßîÊâòËÆøÈóÆËøîÂõû„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">connect</span><span class="params">()</span></span> {</span><br><span class="line">    <span class="keyword">guard</span> <span class="type">WCSession</span>.isSupported () <span class="keyword">else</span> {</span><br><span class="line">        os_log (.debug, log: .watch, <span class="string">"watch session is not supported"</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    }</span><br><span class="line">    os_log (.debug, log: .watch, <span class="string">"activating watch session"</span>)</span><br><span class="line">    session.activate ()</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">session</span><span class="params">(<span class="number">_</span> session: WCSession, </span></span></span><br><span class="line"><span class="function"><span class="params">             activationDidCompleteWith activationState: WCSessionActivationState, </span></span></span><br><span class="line"><span class="function"><span class="params">             error: Error?)</span></span> {</span><br><span class="line">    os_log (.debug, </span><br><span class="line">               log: .watch, </span><br><span class="line">               <span class="string">"did finish activating session % lu (error: % s)"</span>, </span><br><span class="line">               activationState == .activated, </span><br><span class="line">               error?.localizedDescription ?? <span class="string">"none"</span>) </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Âú® watchOS extension target ÈÇ£ËæπÔºåÊàë‰ª¨‰ºöÊ∑ªÂä†Áõ∏‰ººÁöÑ‰ª£Á†ÅÔºå‰∏çËøáÂêçÂ≠ó‰∏ç‰∏ÄÊ†∑ÔºåÂè´ ‚ÄúPhoneConnectivityProvider‚Äù „ÄÇÂΩì‰∏§‰∏™Á±ªÈÉΩÂàõÂª∫ÂÆåÊàêÂêéÔºåÊàë‰ª¨ÈúÄË¶ÅÂàùÂßãÂåñÂπ∂Ë∞ÉÁî® connect ÔºåÂàÜÂà´Âú® <code>SceneDelegate</code> (iOS) Âíå <code>ExtensionDelegate</code> (watchOS) ‰∏≠ÂÆåÊàê„ÄÇÊ≥®ÊÑèÔºåÂú® iOS app ËøôËæπÔºåÊàë‰ª¨ÈúÄË¶ÅÂÆûÁé∞‰∏§‰∏™ÂßîÊâòÊñπÈù¢Ôºå‰∏çËøáÁõÆÂâçÊàë‰ª¨ÁÆÄÂçïÊâìÂç∞Â∞±ÂèØ‰ª•‰∫Ü„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sessionDidBecomeInactive</span><span class="params">(<span class="number">_</span> session: WCSession)</span></span> {</span><br><span class="line">    os_log (.debug, log: .watch, <span class="string">"session became inactive"</span>)</span><br><span class="line">}</span><br><span class="line">     </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sessionDidDeactivate</span><span class="params">(<span class="number">_</span> session: WCSession)</span></span> {</span><br><span class="line">    os_log (.debug, log: .watch, <span class="string">"session deactivated"</span>)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>‰∏∫‰∫ÜÊµãËØï session ÔºåÊàë‰ª¨ÈúÄË¶ÅÂÖàÁºñËØëÂπ∂ËøêË°åÔºåÁÑ∂ÂêéÂú®ÁºñËØëËøêË°å watchOS app „ÄÇÂ¶ÇÊûú‰∏ÄÂàáÂ∑•‰ΩúÊ≠£Â∏∏Ôºå Xcode Ë∞ÉËØïÁ™óÂè£‰ºöÊâìÂç∞Âá∫Ê∂àÊÅØÔºö ‚Äúdid finish activating session 1 (error: none)‚Äù. ËøôË°®Êòé session Â∑≤ÁªèÂª∫Á´ãÂπ∂‰∏îÊ≠£Âú®ËøêË°åÔºåÊàë‰ª¨ÂèØ‰ª•‰∏§‰∏™ app Èó¥ÂèëÈÄÅÊ∂àÊÅØ‰∫Ü„ÄÇ</p>
<h2 id="Fetching-plants-from-iOS-app"><a href="#Fetching-plants-from-iOS-app" class="headerlink" title="Fetching plants from iOS app"></a>Fetching plants from iOS app</h2><p>Âõ†‰∏∫ iOS Âíå watchOS app ‰πãÈó¥ÁöÑÈÄö‰ø°‰æùËµñÂ≠óÂÖ∏ÔºåÊâÄ‰ª•Á¨¨‰∏ÄÊ≠•ÊòØÂÆö‰πâ‰∏ÄÁªÑ‰∏§‰∏™ app ÂÖ±‰∫´‰ΩøÁî®ÁöÑ key „ÄÇËøôÊ†∑ÂèØ‰ª•ÂáèÂ∞ëËØØÊãºÂÜôÁöÑÈ£éÈô©ÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•Ê∑ªÂä†Êñ∞Êñá‰ª∂ÔºåÂπ∂‰∏îÂêåÊó∂ÂåÖÂê´Âà∞ iOS app target Âíå watchOS extension target ‰∏≠Âéª„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">WatchCommunication</span> </span>{</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> requestKey = <span class="string">"request"</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> responseKey = <span class="string">"response"</span></span><br><span class="line">     </span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">Content</span>: <span class="title">String</span> </span>{</span><br><span class="line">        <span class="keyword">case</span> allPlants</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Á¨¨‰∫åÊ≠•ÊòØÂú® <code>PhoneConnectivityProvider</code> (watchOS app extension target) ‰∏≠ÂÆûÁé∞‰∏Ä‰∏™ <code>refreshAllPlants (completionHandler)</code> ÂáΩÊï∞ÔºåÁî®Êù•ÂèëÈÄÅÊ∂àÊÅØÁªô iOS app ÔºåÂπ∂‰∏îÁ≠âÂæÖÊ§çÁâ©Êï∞ÊçÆÁöÑÊï∞ÁªÑËøîÂõû„ÄÇ <code>WCSession</code> Êúâ‰∏Ä‰∏™Âè´  <code>sendMessage (_:replyHandler:errorHandler:)</code> ÁöÑÂáΩÊï∞ÔºåÊàë‰ª¨ÂèØ‰ª•Áî®ÂÆÉÊù•ÂèëÈÄÅ‰∏Ä‰∏™Â≠óÂÖ∏Áªô iOS app ÔºåÁÑ∂ÂêéÁ≠âÂæÖ reply handler „ÄÇÊàë‰ª¨‰ºöÁî® WatchCommunication.requestKey Âíå WatchCommunication.Content.allPlants Êûö‰∏æÁöÑ rawValue Êù•ÊûÑÂª∫Ê∂àÊÅØ„ÄÇËøôÁßçÊ®°Âºè‰æø‰∫éÂêéÁª≠Êâ©Â±ïÔºå‰Ω†Âè™Ë¶ÅÊ∑ªÂä†Êõ¥Âà∞ case Âà∞Êûö‰∏æÂ∞±ÂèØ‰ª•‰∫Ü„ÄÇÂú® reply handler ‰∏≠ÔºåÊàë‰ª¨ÊúüÊúõÂæóÂà∞‰∏Ä‰∏™Â≠óÂÖ∏ÁöÑÊï∞ÁªÑÔºåÊèèËø∞ÊâÄÊúâÁöÑÊ§çÁâ©„ÄÇËÆ©Êàë‰ª¨ÂÖàÁúã‰∏ÄÁúºÂÆåÊï¥ÁöÑÂÆûÁé∞ÔºåÁÑ∂ÂêéÂÜçËÆ®ËÆ∫Â≠óÂÖ∏ÊòØÂ¶Ç‰ΩïË¢´ËΩ¨Êç¢Êàê <code>Plant</code> ÂÄºÁ±ªÂûãÁöÑ„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">refreshAllPlants</span><span class="params">(withCompletionHandler completionHandler: @escaping <span class="params">([Plant]?)</span></span></span> -&gt; <span class="type">Void</span>) {</span><br><span class="line">    <span class="keyword">guard</span> session.activationState == .activated <span class="keyword">else</span> {</span><br><span class="line">        os_log (.debug, log: .phone, <span class="string">"session is not active"</span>)</span><br><span class="line">        completionHandler (<span class="literal">nil</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">let</span> message = [<span class="type">WatchCommunication</span>.requestKey: <span class="type">WatchCommunication</span>.<span class="type">Content</span>.allPlants.rawValue]</span><br><span class="line">    session.sendMessage (message, replyHandler: { (payload) <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">let</span> plantDictionaries = payload [<span class="type">WatchCommunication</span>.requestKey] <span class="keyword">as</span>? [[<span class="type">String</span>: <span class="type">Any</span>]]</span><br><span class="line">        os_log (.debug, log: .phone, <span class="string">"received % lu plants"</span>, plantDictionaries?.<span class="built_in">count</span> ?? <span class="number">0</span>)</span><br><span class="line">             </span><br><span class="line">        <span class="keyword">let</span> decoder = <span class="type">JSONDecoder</span>()</span><br><span class="line">        decoder.dateDecodingStrategy = .secondsSince1970</span><br><span class="line">        <span class="keyword">let</span> plants = plantDictionaries?.compactMap ({ <span class="type">Plant</span>(dictionary: $<span class="number">0</span>, decoder: decoder) })</span><br><span class="line">        <span class="type">DispatchQueue</span>.main.async {</span><br><span class="line">            completionHandler (plants)</span><br><span class="line">        }</span><br><span class="line">    }, errorHandler: { error <span class="keyword">in</span></span><br><span class="line">        os_log (.debug, log: .phone, <span class="string">"sending message failed: % s"</span>, error.localizedDescription)</span><br><span class="line">    })</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>iOS app ‰∏äÂ§ÑÁêÜ CoreData Âíå Plant Á±ªÂûãÁöÑÊòØ‰∏Ä‰∏™ NSManagedObject Â≠êÁ±ªÁöÑÂØπË±°„ÄÇwatchOS app extension ÂÆö‰πâ‰∫ÜÂÆÉËá™Â∑±ÁöÑ <code>Plant</code> ÂÄºÁ±ªÂûãÔºåÂõ†‰∏∫ÂÆÉÂπ∂Ê≤°Êúâ CoreData Ê†à„ÄÇ‰∏∫‰∫ÜÂ∞ÜÂ≠óÂÖ∏ËΩ¨Êç¢ÊàêÂÄºÁ±ªÂûãÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® ‚ÄúStoring struct in UserDefault‚Äù ‰∏≠ÊèèËø∞ÁöÑÊñπÊ≥ïÔºåÂè™ÈúÄË¶ÅÈ¢ùÂ§ñÈÖçÁΩÆ <code>JSONDecoder</code> ‰ΩøÁî®ÁöÑ <code>dateDecodingStrategy</code>  ‰∏∫ <code>secondsSince1970</code> „ÄÇÁêÜÁî±ÊòØÊàë‰ª¨Â∏åÊúõ‰ª•Ëá™ 1970 Âπ¥‰πãÂêéÁöÑÁßíÊï∞Êù•Â≠òÂÇ®Êó•Êúü„ÄÇËΩ¨Êç¢Â≠óÂÖ∏Âà∞ÂÄºÁ±ªÂûãÁöÑËøáÁ®ãÁî®Âà∞‰∫Ü <code>JSONSerialization</code> ÔºåÂÆÉÂè™ÊîØÊåÅ <code>NSString</code> Ôºå <code>NSNumber</code> Ôºå <code>NSArray</code> Ôºå <code>NSDictionary</code> Ôºå ÊàñËÄÖ <code>NSNull</code> „ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Plant value type in WatchOS app extension</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Plant</span>: <span class="title">Identifiable</span>, <span class="title">Decodable</span>, <span class="title">DictionaryDecodable</span> </span>{</span><br><span class="line">    <span class="keyword">let</span> id: <span class="type">String</span></span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">let</span> lastWateringDate: <span class="type">Date</span></span><br><span class="line">    <span class="keyword">let</span> nextWateringDate: <span class="type">Date</span></span><br><span class="line">}</span><br><span class="line"><span class="comment">// Plant class in iOS app</span></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Plant</span>: <span class="title">NSManagedObject</span>, <span class="title">Identifiable</span> </span>{</span><br><span class="line">    <span class="meta">@NSManaged</span> <span class="keyword">var</span> id: <span class="type">String</span></span><br><span class="line">    <span class="meta">@NSManaged</span> <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">     </span><br><span class="line">    <span class="meta">@NSManaged</span> <span class="keyword">var</span> lastWateringDate: <span class="type">Date</span></span><br><span class="line">    <span class="meta">@NSManaged</span> <span class="keyword">var</span> nextWateringDate: <span class="type">Date</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Á¨¨‰∏âÊ≠•ÊòØÂú® iOS app Á´ØÂ§ÑÁêÜÊ∂àÊÅØÔºåÂπ∂‰∏îÊèê‰æõÊï∞ÊçÆÁªô watchOS app „ÄÇÊàë‰ª¨ÈúÄË¶ÅÂÅöÁöÑÊòØÂÆûÁé∞ session ÁöÑÂßîÊâòÔºå‰ªé CoreData Ê†à‰∏≠Ëé∑ÂèñÂ≠óÂÖ∏Êï∞ÊçÆ„ÄÇ ÂÖàÁúã‰∏ãÂÆåÊï¥ÂÆûÁé∞ÔºåÁÑ∂ÂêéÈÄê‰∏ÄÊãÜËß£„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">session</span><span class="params">(<span class="number">_</span> session: WCSession, didReceiveMessage message: [String: <span class="keyword">Any</span>], replyHandler: @escaping <span class="params">([String: <span class="keyword">Any</span>])</span></span></span> -&gt; <span class="type">Void</span>) {</span><br><span class="line">    os_log (.debug, log: .watch, <span class="string">"did receive message: % s"</span>, message [<span class="type">WatchCommunication</span>.requestKey] <span class="keyword">as</span>? <span class="type">String</span> ?? <span class="string">"unknown"</span>)</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> contentString = message [<span class="type">WatchCommunication</span>.requestKey] <span class="keyword">as</span>? <span class="type">String</span> , <span class="keyword">let</span> content = <span class="type">WatchCommunication</span>.<span class="type">Content</span>(rawValue: contentString) <span class="keyword">else</span> {</span><br><span class="line">        replyHandler ([:])</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">switch</span> content {</span><br><span class="line">    <span class="keyword">case</span> .allPlants:</span><br><span class="line">        persistentContainer.performBackgroundTask { (managedObjectContext) <span class="keyword">in</span>            </span><br><span class="line">            <span class="keyword">let</span> all = <span class="type">Plant</span>.allPlantsDictionaryRepresentation () <span class="keyword">as</span>! [[<span class="type">String</span>: <span class="type">Any</span>]]</span><br><span class="line">            <span class="comment">// Replace Date with Double</span></span><br><span class="line">            <span class="keyword">let</span> converted = all.<span class="built_in">map</span> { (plantDictionary) -&gt; [<span class="type">String</span>: <span class="type">Any</span>] <span class="keyword">in</span></span><br><span class="line">                plantDictionary.mapValues { (value) -&gt; <span class="type">Any</span> <span class="keyword">in</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">let</span> date = value <span class="keyword">as</span>? <span class="type">Date</span> {</span><br><span class="line">                        <span class="keyword">return</span> date.timeIntervalSince1970</span><br><span class="line">                    }</span><br><span class="line">                    <span class="keyword">else</span> {</span><br><span class="line">                        <span class="keyword">return</span> value</span><br><span class="line">                    }</span><br><span class="line">                }</span><br><span class="line">            }                </span><br><span class="line">            <span class="keyword">let</span> response = [<span class="type">WatchCommunication</span>.responseKey: converted]</span><br><span class="line">            replyHandler (response)</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Á¨¨‰∏ÄÊ≠•ÊòØÊü•ÁúãÊé•Êî∂Âà∞ÁöÑÂ≠óÂÖ∏ÔºåÁúãÁúã watchOS app ËØ∑Ê±ÇÁöÑÊòØÂì™‰∫õÂÜÖÂÆπ„ÄÇÁÑ∂ÂêéÊàë‰ª¨ËÆøÈóÆÊåÅ‰πÖÂåñÂ≠òÂÇ®ÔºåËé∑ÂèñË°®Á§∫ Plant ÁöÑÂ≠óÂÖ∏ÔºåÊääÂÖ∂‰ªñÁöÑÊó•ÊúüËΩ¨Êç¢Êàê 1970 Âπ¥ÂêéÁßíÊï∞ÁöÑÂΩ¢Âºè (‰ª•‰æø watchOS app ËÉΩÂ§üÂú®Â≠óÂÖ∏‰∏ä‰ΩøÁî® <code>JSONSerialization</code>)ÔºåÁÑ∂ÂêéÊääÊï∞ÊçÆÂèëÈÄÅÂõû watchOS app „ÄÇÊ≥®ÊÑèÔºå‰ªé CoreData ‰∏≠Ëé∑ÂèñÂ≠óÂÖ∏ÂΩ¢ÂºèÁöÑ Plant ÂæàÂÆπÊòìÔºöÊàë‰ª¨È¶ñÂÖàÊòØËØ∑Ê±Ç <code>NSDictionary</code> Á±ªÂûãÁöÑÊï∞ÊçÆÔºåÂπ∂‰∏îÂ∞ÜÁªìÊûúÁ±ªÂûãÂ±ûÊÄßËÆæÁΩÆ‰∏∫ <code>.dictionaryResultType</code> „ÄÇÂØπ‰∫éÂêÑÂ∫ûÂ§ßÁöÑÊ®°ÂûãÔºåÊàë‰ª¨ÂèØËÉΩËøò‰ºöÁî®Âà∞Â±ûÊÄßÈõÜÂêà (propertiesToFetch) „ÄÇ‰∏çËøáÁõÆÂâçÔºåÊâÄÊúâÁöÑÂ±ûÊÄßÈÉΩË¢´Ê∑ªÂä†Âà∞Â≠óÂÖ∏‰∏≠‰∫Ü„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Plant</span> </span>{</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> entityName = <span class="string">"Plant"</span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">makeDictionaryRequest</span><span class="params">()</span></span> -&gt; <span class="type">NSFetchRequest</span>&lt;<span class="type">NSDictionary</span>&gt; {</span><br><span class="line">        <span class="keyword">return</span> <span class="type">NSFetchRequest</span>&lt;<span class="type">NSDictionary</span>&gt;(entityName: entityName)</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">allPlantsDictionaryRepresentation</span><span class="params">()</span></span> -&gt; [<span class="type">NSDictionary</span>] {</span><br><span class="line">        <span class="keyword">let</span> request = makeDictionaryRequest ()</span><br><span class="line">        request.resultType = .dictionaryResultType</span><br><span class="line">        <span class="keyword">do</span> {</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">try</span> request.execute ()</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">catch</span> <span class="keyword">let</span> nsError <span class="keyword">as</span> <span class="type">NSError</span> {</span><br><span class="line">            os_log (.debug, log: .plants, <span class="string">"failed fetching all plants with error % s % s"</span>, nsError, nsError.userInfo)</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="Áî®-SwiftUI-Âú®-watchOS-app-‰∏≠ÊûÑÂª∫-UI"><a href="#Áî®-SwiftUI-Âú®-watchOS-app-‰∏≠ÊûÑÂª∫-UI" class="headerlink" title="Áî® SwiftUI Âú® watchOS app ‰∏≠ÊûÑÂª∫ UI"></a>Áî® SwiftUI Âú® watchOS app ‰∏≠ÊûÑÂª∫ UI</h2><p>Xcode ‰∏≠ watchOS app ÁöÑÊ®°ÊùøÊòØÂÄüÂä© storyboard ÂàùÂßãÂåñ <code>HostingController</code>Ôºå Ëøô‰∏™ÊéßÂà∂Âô®Ë¥üË¥£Êèê‰æõÂàùÂßãÁöÑ SwiftUI ËßÜÂõæ„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HostingController</span>: <span class="title">WKHostingController</span>&lt;<span class="title">PlantListView</span>&gt; </span>{</span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">private</span>(<span class="keyword">set</span>) <span class="keyword">var</span> connectivityProvider: <span class="type">PhoneConnectivityProvider</span> = {</span><br><span class="line">        <span class="keyword">let</span> provider = <span class="type">PhoneConnectivityProvider</span>()</span><br><span class="line">        provider.connect ()</span><br><span class="line">        <span class="keyword">return</span> provider</span><br><span class="line">    }()</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">lazy</span> <span class="keyword">var</span> listViewModel = <span class="type">PlantListViewModel</span>(connectivityProvider: connectivityProvider)</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">var</span> body: <span class="type">PlantListView</span> {</span><br><span class="line">        <span class="keyword">return</span> <span class="type">PlantListView</span>(viewModel: listViewModel)</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><code>PlantListView</code> ÊòØ‰∏Ä‰∏™ÊòæÁ§∫Ê§çÁâ©ÂàóË°®ÁöÑÁÆÄÂçïËßÜÂõæÔºåÂÆÉÁî® <code>PhoneConnectivityProvider</code> ÁöÑ <code>refreshAllPlants (withCompletionHandler:)</code> Êù•Â§ÑÁêÜÂà∑Êñ∞Ê§çÁâ©ÁöÑÈÄªËæë„ÄÇ SwiftUI ËßÜÂõæ‰ºöÂú® view model ÊîπÂèòÊó∂Ëá™Âä®Êõ¥Êñ∞„ÄÇËøôÊòØÂõ†‰∏∫ view model ÁöÑ <code>plants</code> Â±ûÊÄß‰ΩøÁî®‰∫Ü <code>@Published</code> Â±ûÊÄßÂåÖË£ÖÂô®ÔºåËÄå view model Êú¨Ë∫´ÊòØ <code>ObservableObject</code> ÔºåËøôÊòØ SwiftUI ËßÜÂõæ‰∏≠‰∏∫ view model ÈááÁî®ÁöÑÂ±ûÊÄßÂåÖË£ÖÂô® (Êõ¥Â§ö‰ø°ÊÅØÂèØ‰ª•ÈòÖËØª refreshing SwiftUI view in MVVM in SwiftUI) „ÄÇÊ≥®ÊÑèÔºåËøôÈáåÁöÑ view model ÊòØ SwiftUI ËßÜÂõæÊòæÁé∞Êó∂Âà∑Êñ∞ÂÜÖÂÆπÁöÑ„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">PlantListViewModel</span>: <span class="title">ObservableObject</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> connectivityProvider: <span class="type">PhoneConnectivityProvider</span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">init</span>(plants: [<span class="type">Plant</span>] = [], connectivityProvider: <span class="type">PhoneConnectivityProvider</span>) {</span><br><span class="line">        <span class="keyword">self</span>.plants = plants</span><br><span class="line">        <span class="keyword">self</span>.connectivityProvider = connectivityProvider</span><br><span class="line">        refresh ()</span><br><span class="line">    }</span><br><span class="line">    @<span class="type">Published</span> <span class="keyword">private</span>(<span class="keyword">set</span>) <span class="keyword">var</span> plants: [<span class="type">Plant</span>]</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">refresh</span><span class="params">()</span></span> {</span><br><span class="line">        connectivityProvider.refreshAllPlants { [<span class="keyword">weak</span> <span class="keyword">self</span>] (plants) <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> plants = plants <span class="keyword">else</span> { <span class="keyword">return</span> }</span><br><span class="line">            <span class="keyword">self</span>?.plants = plants</span><br><span class="line">        }</span><br><span class="line">    }    </span><br><span class="line">}</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PlantListView</span>: <span class="title">View</span> </span>{</span><br><span class="line">    @<span class="type">ObservedObject</span> <span class="keyword">var</span> viewModel: <span class="type">PlantListViewModel</span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> {</span><br><span class="line">        <span class="type">VStack</span> {</span><br><span class="line">            <span class="type">List</span>(<span class="keyword">self</span>.viewModel.plants) { plant <span class="keyword">in</span></span><br><span class="line">                <span class="type">PlantCell</span>(viewModel: <span class="type">PlantCellViewModel</span>(plant: plant))</span><br><span class="line">            }</span><br><span class="line">        }.onAppear {</span><br><span class="line">            <span class="keyword">self</span>.viewModel.refresh ()</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><code>PlantListView</code> Áî® <code>PlantCell</code> Êù•ÊòæÁ§∫Áã¨Á´ãÁöÑËßÜÂõæ„ÄÇ</p>
<figure class="highlight swift"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PlantCell</span>: <span class="title">View</span> </span>{</span><br><span class="line">    <span class="keyword">let</span> viewModel: <span class="type">PlantCellViewModel</span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> {</span><br><span class="line">        <span class="type">VStack</span>(spacing: <span class="number">4</span>) {</span><br><span class="line">            <span class="type">Text</span>(viewModel.title).font (.headline).multilineTextAlignment (.center)</span><br><span class="line">            <span class="type">Text</span>(viewModel.subtitle).font (.footnote).multilineTextAlignment (.center)</span><br><span class="line">        }.padding (<span class="number">8</span>)</span><br><span class="line">            .frame (minWidth: <span class="number">0</span>, maxWidth: .greatestFiniteMagnitude)</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PlantCellViewModel</span> </span>{</span><br><span class="line">    <span class="keyword">let</span> plant: <span class="type">Plant</span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">var</span> title: <span class="type">String</span> {</span><br><span class="line">        <span class="keyword">return</span> plant.name</span><br><span class="line">    }</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">let</span> dateFormatter: <span class="type">DateFormatter</span> = {</span><br><span class="line">        <span class="keyword">let</span> formatter = <span class="type">DateFormatter</span>()</span><br><span class="line">        formatter.dateFormat = <span class="type">DateFormatter</span>.dateFormat (fromTemplate: <span class="string">"dMMMM"</span>, options: <span class="number">0</span>, locale: .current)</span><br><span class="line">        <span class="keyword">return</span> formatter</span><br><span class="line">    }()</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">var</span> subtitle: <span class="type">String</span> {</span><br><span class="line">        <span class="keyword">let</span> format = <span class="type">NSLocalizedString</span>(<span class="string">"PlantCellView_NextWatering"</span>, comment: <span class="string">"Next watering date."</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="type">String</span>(format: format, <span class="type">Self</span>.dateFormatter.string (from: plant.nextWateringDate))</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="Â∞èÁªì-1"><a href="#Â∞èÁªì-1" class="headerlink" title="Â∞èÁªì"></a>Â∞èÁªì</h2><p>Êàë‰ª¨Âú® iOS Âíå watchOS app ‰∏äÈÉΩÊ∑ªÂä† <code>WCSessions</code> ÔºåÂÆûÁé∞Áõ∏ÂÖ≥ÁöÑÂßîÊâòÊñπÊ≥ï‰ª•Â§ÑÁêÜ session ÂíåÊé•Êî∂Âà∞ÁöÑÊ∂àÊÅØ„ÄÇÁÑ∂ÂêéÔºåÊàë‰ª¨ÂÆö‰πâ‰∏Ä‰∏™ÁÆÄÂçïÁöÑÈÄö‰ø°Ê®°ÂºèÔºåÂπ∂Âú® watchOS app Á´ØÂÆûÁé∞Âà∑Êñ∞Ê§çÁâ©ÁöÑÊñπÊ≥ïÔºåÂú® iOS Á´ØÂÆûÁé∞ CoreData ÈõÜÊàê„ÄÇÂΩìÊï∞ÊçÆËÆøÈóÆÂàõÂª∫ÂÆåÊàêÂêéÔºåÊàë‰ª¨Âú® watchOS app ‰∏äÁî® SwiftUI ËßÜÂõæÊòæÁ§∫Ê§çÁâ©ÁöÑÂàóË°®„ÄÇ</p>
<hr>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="‰∏ã‰∏ÄÈ°µ"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          ÊñáÁ´†ÁõÆÂΩï
        </li>
        <li class="sidebar-nav-overview">
          Á´ôÁÇπÊ¶ÇËßà
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Áå´ÂÖãÊùØ"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Áå´ÂÖãÊùØ</p>
  <div class="site-description" itemprop="description">Stay hungry, stay foolish.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">50</span>
          <span class="site-state-item-name">Êó•Âøó</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">ÂàÜÁ±ª</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">Ê†áÁ≠æ</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/nichollyn" title="GitHub ‚Üí https:&#x2F;&#x2F;github.com&#x2F;nichollyn" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS ‚Üí &#x2F;atom.xml"><i class="fa fa-fw fa-rss"></i>RSS</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/kai-wen-mao-66" title="Áü•‰πé ‚Üí https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;kai-wen-mao-66" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i>Áü•‰πé</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        
  <div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">ÈóΩICPÂ§á - 20000913 </a>
      <img src="/images/gongan.png" style="display: inline-block;"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=35021302000298" rel="noopener" target="_blank">ÈóΩÂÖ¨ÁΩëÂÆâÂ§á35021302000298Âè∑ </a>
  </div>

<div class="copyright">
  
  &copy; 2019 ‚Äì 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Áå´ÂÖãÊùØ</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="Á´ôÁÇπÊÄªÂ≠óÊï∞">223k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Á´ôÁÇπÈòÖËØªÊó∂Èïø">3:23</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="ÊÄªËÆøÂÆ¢Èáè">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="ÊÄªËÆøÈóÆÈáè">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script size="300" alpha="0.6" zIndex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>


  



  <script>
  if (CONFIG.page.isPost) {
    wpac_init = window.wpac_init || [];
    wpac_init.push({
      widget: 'Rating',
      id: ,
      el: 'wpac-rating',
      color: 'f79533'
    });
    (function() {
      if ('WIDGETPACK_LOADED' in window) return;
      WIDGETPACK_LOADED = true;
      var mc = document.createElement('script');
      mc.type = 'text/javascript';
      mc.async = true;
      mc.src = '//embed.widgetpack.com/widget.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(mc, s.nextSibling);
    })();
  }
  </script>

  
<script src="/js/local-search.js"></script>













  

  
      
<script type="text/x-mathjax-config">

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });

  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') {
          next = next.nextSibling;
        }
        if (next && next.nodeName.toLowerCase() === 'br') {
          next.parentNode.removeChild(next);
        }
      }
    });
  });

  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      element = document.getElementById(all[i].inputID + '-Frame').parentNode;
      if (element.nodeName.toLowerCase() == 'li') {
        element = element.parentNode;
      }
      element.classList.add('has-jax');
    }
  });
</script>
<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML', () => {
    MathJax.Hub.Typeset();
  }, window.MathJax);
</script>

    

  

</body>
</html>
